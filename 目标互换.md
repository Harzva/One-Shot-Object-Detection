# 目标互换

```python
# https://github.com/timy90022/One-Shot-Object-Detection.git
conda create -n OSOD python=3.6
conda activate OSOD2
conda install pytorch==1.0.1 torchvision==0.2.2 cudatoolkit=9.0 -c pytorch
conda install pytorch==1.2.0 torchvision==0.4.0 cudatoolkit=10.0
conda install pytorch==1.2.0 torchvision==0.4.0 cudatoolkit=9.2 -c pytorch

pip install -r requirements.txt
pip install imageio # from imageio import imread

pip install opencv-python
pip install easydict
conda unisntall numpy
# 测试过程中出错 使用了coco官方程序 修改了sem为bbox https://github.com/cocodataset/cocoapi/tree/master/PythonAPI/pycocotools
# VScode 有问题 可以用cmd
# 环境使用OSOD2    用keras的用OSOD4
# voc
pip install scipy
pip install matplotlib
pip install pyyaml
```

**vscode Host3   10.170.29.200     CUDA9.0    OSOD2 OSOD4**

项目地址：/media/sdb1/Data/dyy/One-Shot-Object-Detection       /media/sdb1/Data/dyy/One-Shot-Object-Detection-switch

数据集地址COCO&VOC：/media/sdb1/Data/dyy



**vscode Host2 10.170.40.16  OSOD4**

项目地址：/home/ubuntu/Dataset/Partition1/dyy

数据集地址COCO：/home/ubuntu/Dataset/Dataset/COCO$

数据集地址VOC：/home/ubuntu/LRP/VOCdevkit



z840@10.70.72.217



10.170.13.97

/media/ubuntu/data2/data/VOCdevkit2012/VOC2012

/media/ubuntu/data2 空间大

```python
# COCO数据集

CUDA_VISIBLE_DEVICES=0 python trainval_no_switch.py --dataset coco --net res50 --bs 8 --nw 2 --cuda --g 1 --seen 1   # 训练

CUDA_VISIBLE_DEVICES=1 python trainval_switch.py --dataset coco --net res50 --bs 8 --nw 2 --cuda --g 1 --seen 1 --r yes --checksession 1 --checkepoch 8 --checkpoint 26623 # 断开后接着训练

CUDA_VISIBLE_DEVICES=0 python test_net.py --dataset coco --net res50 --s 1 --checkepoch 11 --p 26623 --cuda --g 1        # 测试12min    s:SESSION    checkpoch:epoch     p:iter,CHECKPOINT   g:split方式

-----------------------------------------------------------------------------------------------------
# 另一台电脑 COCO数据集
CUDA_VISIBLE_DEVICES=0 python trainval_net.py --dataset coco --net res50 --bs 8 --nw 2 --cuda --g 1 --seen 1    #　训练
CUDA_VISIBLE_DEVICES=0 python trainval_net.py --dataset coco --net res50 --bs 8 --nw 2 --cuda --g 1 --seen 1 --r yes --checksession 1 --checkepoch 10 --checkpoint 26623
CUDA_VISIBLE_DEVICES=0 python test_net.py --dataset coco --net res50 --s 1 --checkepoch 1 --p 26623 --cuda --g 1　　# 测试

-----------------------------------------------------------------------------------------------------
# 另一台电脑   VOC数据集
# One-Shot-Object-Detection-voc
CUDA_VISIBLE_DEVICES=0 python trainval_net.py --dataset pascal_voc_0712 --net res50 --bs 8 --nw 2 --cuda --g 1 --seen 1   # 训练18.3h 55min/per epoch
CUDA_VISIBLE_DEVICES=1 python trainval_net.py --dataset pascal_voc_0712 --net res50 --bs 8 --nw 2 --cuda --g 1 --seen 1 --r yes --checksession 1 --checkepoch 7 --checkpoint 3320
CUDA_VISIBLE_DEVICES=1 python test_net.py --dataset pascal_voc_0712 --net res50 --s 1 --checkepoch 20 --p 3320 --cuda --g 1     # 测试1.5min
rm -f /home/ubuntu/Dataset/Partition1/dyy/One-Shot-Object-Detection-voc/output/res50/voc_2007_test/faster_rcnn_unseen/*

# One-Shot-Object-Detection-voc/lib/datasets/pascal_voc.py
def _do_python_eval(self, output_dir='output'):
    save_str = "{:0.3f}|{:0.3f}|{:0.3f}|{:0.3f}|{:0.3f}\n".format(aps[0],aps[7],aps[9],aps[16],(aps[0]+aps[7]+aps[9]+aps[16])/4)
    txt_path = '/home/ubuntu/Dataset/Partition1/dyy/One-Shot-Object-Detection-voc/result_save.txt'
    txt_file = open(txt_path,'a')
    txt_file.write(save_str)
    txt_file.close()

-----------------------------------------------------------------------------------------------------
# One-Shot-Object-Detection
for i in {1..10};do
	rm -f /media/sdb1/Data/dyy/One-Shot-Object-Detection/output/res50/coco_2017_val/faster_rcnn_unseen/*
	CUDA_VISIBLE_DEVICES=0 python test_write.py --dataset coco --net res50 --s 1 --checkepoch $i --p 26623 --cuda --g 1
done

-----------------------------------------------------------------------------------------------------
# One-Shot-Object-Detection-switch
for i in {1..10};do
	rm -f /media/sdb1/Data/dyy/One-Shot-Object-Detection-switch/output/res50/coco_2017_val/faster_rcnn_unseen/*
	CUDA_VISIBLE_DEVICES=1 python test_write.py --dataset coco --net res50 --s 1 --checkepoch $i --p 26623 --cuda --g 1
done

# One-Shot-Object-Detection-switch/test_write.py
# load_name
txt_path = '/media/sdb1/Data/dyy/One-Shot-Object-Detection-switch/result_save.txt'
txt_file = open(txt_path,'a')
txt_file.write('{}_{}|'.format(args.checksession, args.checkepoch))
txt_file.close()
# One-Shot-Object-Detection-switch/lib/datasets/coco.py
def _summarizeDets():
    save_str = "{:0.3f}|{:0.3f}".format(stats[0],stats[1])
    txt_path = '/media/sdb1/Data/dyy/One-Shot-Object-Detection-switch/result_save.txt'
    txt_file = open(txt_path,'a')
    txt_file.write(save_str)
    txt_file.close()
```



## VOC数据集

 [2, 3, 4, 5, 6, 7, 9, 11, 12, 13, 14, 15, 16, 18, 19, 20]

![image-20211120103910070](F:\code-markdown\image-20211120103910070.png)





| support>0.5+p128+new_loss | aeroplane | cat   | cow   | sheep | Mean AP |
| ------------------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1                       | 0.473     | 0.669 | 0.744 | 0.620 | 0.626   |
| 1_2                       | 0.486     | 0.741 | 0.766 | 0.617 | 0.652   |
| 1_3                       | 0.540     | 0.694 | 0.777 | 0.664 | 0.669   |
| 1_4                       | 0.459     | 0.728 | 0.771 | 0.649 | 0.652   |
| 1_5                       | 0.511     | 0.811 | 0.837 | 0.731 | 0.722   |
| 1_6                       | 0.444     | 0.807 | 0.846 | 0.722 | 0.704   |
| 1_7                       | 0.456     | 0.825 | 0.854 | 0.741 | 0.719   |
| 1_8                       | 0.494     | 0.820 | 0.837 | 0.747 | 0.724   |
| 1_9                       | 0.491     | 0.815 | 0.840 | 0.745 | 0.723   |
| 1_10                      | 0.476     | 0.808 | 0.850 | 0.726 | 0.715   |

| new_loss | aeroplane | cat   | cow   | sheep | Mean AP |
| -------- | --------- | ----- | ----- | ----- | ------- |
| 1_1      | 0.473     | 0.669 | 0.744 | 0.620 | 0.626   |
| 1_2      | 0.400     | 0.692 | 0.803 | 0.639 | 0.633   |
| 1_3      | 0.443     | 0.712 | 0.771 | 0.670 | 0.649   |
| 1_4      | 0.473     | 0.803 | 0.823 | 0.688 | 0.697   |
| 1_5      | 0.479     | 0.806 | 0.829 | 0.734 | 0.712   |
| 1_6      | 0.504     | 0.814 | 0.842 | 0.718 | 0.719   |
| 1_7      | 0.467     | 0.815 | 0.846 | 0.723 | 0.713   |
| 1_8      | 0.496     | 0.807 | 0.829 | 0.718 | 0.712   |
| 1_9      | 0.503     | 0.805 | 0.833 | 0.725 | 0.716   |
| 1_10     | 0.481     | 0.813 | 0.853 | 0.734 | 0.720   |

| 原   | aeroplane | cat   | cow   | sheep | Mean AP |
| ---- | --------- | ----- | ----- | ----- | ------- |
| 1_1  | 0.373     | 0.688 | 0.745 | 0.585 | 0.598   |
| 1_2  | 0.444     | 0.734 | 0.790 | 0.661 | 0.658   |
| 1_3  | 0.498     | 0.691 | 0.775 | 0.637 | 0.650   |
| 1_4  | 0.554     | 0.705 | 0.813 | 0.656 | 0.682   |
| 1_5  | 0.467     | 0.806 | 0.852 | 0.725 | 0.712   |
| 1_6  | 0.494     | 0.806 | 0.859 | 0.716 | 0.719   |
| 1_7  | 0.526     | 0.807 | 0.863 | 0.724 | 0.730   |
| 1_8  | 0.461     | 0.792 | 0.866 | 0.743 | 0.715   |
| 1_9  | 0.502     | 0.805 | 0.850 | 0.734 | 0.723   |
| 1_10 | 0.487     | 0.802 | 0.852 | 0.738 | 0.719   |

| support>0.5+new_l | aeroplane | cat   | cow   | sheep | Mean AP |
| ----------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1               | 0.378     | 0.661 | 0.756 | 0.602 | 0.599   |
| 1_2               | 0.444     | 0.712 | 0.758 | 0.661 | 0.643   |
| 1_3               | 0.456     | 0.755 | 0.807 | 0.698 | 0.679   |
| 1_4               | 0.458     | 0.660 | 0.737 | 0.610 | 0.616   |
| 1_5               | 0.515     | 0.797 | 0.852 | 0.689 | 0.713   |
| 1_6               | 0.473     | 0.808 | 0.852 | 0.734 | 0.717   |
| 1_7               | 0.475     | 0.811 | 0.833 | 0.708 | 0.707   |
| 1_8               | 0.524     | 0.817 | 0.850 | 0.737 | 0.732   |
| 1_9               | 0.503     | 0.820 | 0.845 | 0.730 | 0.724   |
| 1_10              | 0.476     | 0.829 | 0.859 | 0.724 | 0.722   |

|      | aeroplane | cat  | cow  | sheep | Mean AP |
| ---- | --------- | ---- | ---- | ----- | ------- |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |

|      | aeroplane | cat  | cow  | sheep | Mean AP |
| ---- | --------- | ---- | ---- | ----- | ------- |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |

|      | aeroplane | cat  | cow  | sheep | Mean AP |
| ---- | --------- | ---- | ---- | ----- | ------- |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |
|      |           |      |      |       |         |









|                          | Epoch10   | Max       |
| ------------------------ | --------- | --------- |
| 初始训练                 | 0.724     | 0.729     |
| 目标互换0.5              | 0.715     | 0.724     |
| 目标互换0.4              | 0.720     | 0.730     |
| 目标互换0.3              | 0.728     | 0.730     |
| 目标互换0.2              | **0.735** | **0.735** |
| 目标互换0.1              | 0.723     | 0.734     |
| 不互换+projector 64      | 0.728     | 0.732     |
| 不互换+projector 128     | 0.733     | 0.733     |
| 不互换+projector 256     | 0.716     | 0.726     |
| 不互换+projector 512     | 0.727     | 0.734     |
| 不互换+projector 1024    | 0.721     | 0.728     |
| 不互换+projector 2048    | 0.713     | 0.721     |
| 不互换+loss Barlow Twins | 0.734     | 0.740     |
| support > 0.5            | 0.733     | 0.744     |
| support > 0.6            |           |           |
| support >0.7             | 0.724     | 0.737     |
| crop > 0.5               | 0.715     | 0.719     |
| crop > 0.6               | 0.726     | 0.734     |
| crop> 0.7                | 0.721     | 0.723     |
| 目标互换0.3+p128         | 0.721     |           |
| 目标互换0.3+p512         | 0.727     |           |

| 互换0.2+loss | aeroplane | cat   | cow   | sheep | Mean AP |
| ------------ | --------- | ----- | ----- | ----- | ------- |
| 1_1          | 0.551     | 0.672 | 0.690 | 0.543 | 0.614   |
| 1_2          | 0.366     | 0.707 | 0.771 | 0.684 | 0.632   |
| 1_3          | 0.461     | 0.768 | 0.798 | 0.668 | 0.674   |
| 1_4          | 0.431     | 0.812 | 0.771 | 0.686 | 0.675   |
| 1_5          | 0.482     | 0.828 | 0.833 | 0.726 | 0.717   |
| 1_6          | 0.426     | 0.833 | 0.826 | 0.720 | 0.701   |
| 1_7          | 0.451     | 0.833 | 0.844 | 0.724 | 0.713   |
| 1_8          | 0.496     | 0.848 | 0.848 | 0.722 | 0.728   |
| 1_9          | 0.487     | 0.854 | 0.836 | 0.740 | 0.729   |
| 1_10         | 0.471     | 0.851 | 0.840 | 0.748 | 0.728   |

| support>0.5+loss | aeroplane | cat   | cow   | sheep | Mean AP |
| ---------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1              | 0.406     | 0.650 | 0.735 | 0.653 | 0.611   |
| 1_2              | 0.485     | 0.780 | 0.769 | 0.653 | 0.672   |
| 1_3              | 0.478     | 0.799 | 0.798 | 0.713 | 0.697   |
| 1_4              | 0.362     | 0.794 | 0.800 | 0.721 | 0.670   |
| 1_5              | 0.467     | 0.845 | 0.846 | 0.734 | 0.723   |
| 1_6              | 0.471     | 0.840 | 0.835 | 0.726 | 0.718   |
| 1_7              | 0.516     | 0.847 | 0.850 | 0.746 | 0.740   |
| 1_8              | 0.499     | 0.841 | 0.860 | 0.725 | 0.731   |
| 1_9              | 0.442     | 0.853 | 0.843 | 0.735 | 0.718   |
| 1_10             | 0.464     | 0.858 | 0.849 | 0.735 | 0.727   |

| support>0.6+loss | aeroplane | cat   | cow   | sheep | Mean AP |
| ---------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1              | 0.354     | 0.660 | 0.684 | 0.567 | 0.566   |
| 1_2              | 0.421     | 0.743 | 0.727 | 0.593 | 0.621   |
| 1_3              | 0.437     | 0.770 | 0.778 | 0.695 | 0.670   |
| 1_4              | 0.364     | 0.793 | 0.817 | 0.684 | 0.664   |
| 1_5              | 0.506     | 0.838 | 0.846 | 0.721 | 0.728   |
| 1_6              | 0.528     | 0.837 | 0.836 | 0.730 | 0.733   |
| 1_7              | 0.493     | 0.834 | 0.836 | 0.743 | 0.726   |
| 1_8              | 0.507     | 0.837 | 0.838 | 0.749 | 0.733   |
| 1_9              | 0.494     | 0.848 | 0.840 | 0.745 | 0.732   |
| 1_10             | 0.496     | 0.844 | 0.844 | 0.734 | 0.730   |

| 互换0.2+projector64 | aeroplane | cat   | cow   | sheep | Mean AP |
| ------------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1                 | 0.443     | 0.649 | 0.706 | 0.573 | 0.593   |
| 1_2                 | 0.359     | 0.676 | 0.711 | 0.617 | 0.591   |
| 1_3                 | 0.326     | 0.750 | 0.820 | 0.687 | 0.646   |
| 1_4                 | 0.435     | 0.775 | 0.793 | 0.660 | 0.665   |
| 1_5                 | 0.460     | 0.840 | 0.842 | 0.734 | 0.719   |
| 1_6                 | 0.503     | 0.846 | 0.845 | 0.722 | 0.729   |
| 1_7                 | 0.521     | 0.837 | 0.847 | 0.715 | 0.730   |
| 1_8                 | 0.477     | 0.846 | 0.823 | 0.715 | 0.715   |
| 1_9                 | 0.457     | 0.841 | 0.832 | 0.744 | 0.719   |
| 1_10                | 0.492     | 0.857 | 0.840 | 0.739 | 0.732   |

| 互换0.2+projector128 | aeroplane | cat   | cow   | sheep | Mean AP |
| -------------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1                  | 0.335     | 0.671 | 0.688 | 0.603 | 0.574   |
| 1_2                  | 0.424     | 0.717 | 0.771 | 0.638 | 0.638   |
| 1_3                  | 0.368     | 0.814 | 0.739 | 0.719 | 0.660   |
| 1_4                  | 0.407     | 0.772 | 0.774 | 0.702 | 0.664   |
| 1_5                  | 0.469     | 0.831 | 0.832 | 0.723 | 0.714   |
| 1_6                  | 0.465     | 0.840 | 0.836 | 0.715 | 0.714   |
| 1_7                  | 0.476     | 0.846 | 0.829 | 0.727 | 0.719   |
| 1_8                  | 0.470     | 0.855 | 0.830 | 0.725 | 0.720   |
| 1_9                  | 0.510     | 0.839 | 0.818 | 0.717 | 0.721   |
| 1_10                 | 0.481     | 0.851 | 0.833 | 0.733 | 0.725   |

| 互换0.2+projector512 | aeroplane | cat   | cow   | sheep | Mean AP |
| -------------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1                  | 0.358     | 0.666 | 0.711 | 0.615 | 0.587   |
| 1_2                  | 0.305     | 0.721 | 0.719 | 0.647 | 0.598   |
| 1_3                  | 0.449     | 0.774 | 0.740 | 0.635 | 0.650   |
| 1_4                  | 0.448     | 0.780 | 0.793 | 0.695 | 0.679   |
| 1_5                  | 0.458     | 0.824 | 0.839 | 0.695 | 0.704   |
| 1_6                  | 0.460     | 0.836 | 0.850 | 0.706 | 0.713   |
| 1_7                  | 0.521     | 0.839 | 0.833 | 0.699 | 0.723   |
| 1_8                  | 0.513     | 0.835 | 0.839 | 0.708 | 0.724   |
| 1_9                  | 0.488     | 0.850 | 0.830 | 0.724 | 0.723   |
| 1_10                 | 0.478     | 0.840 | 0.844 | 0.741 | 0.726   |

| support>0.6+projector64 | aeroplane | cat   | cow   | sheep | Mean AP |
| ----------------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1                     | 0.400     | 0.680 | 0.734 | 0.572 | 0.596   |
| 1_2                     | 0.401     | 0.782 | 0.783 | 0.680 | 0.662   |
| 1_3                     | 0.474     | 0.799 | 0.804 | 0.653 | 0.682   |
| 1_4                     | 0.395     | 0.753 | 0.786 | 0.695 | 0.657   |
| 1_5                     | 0.447     | 0.838 | 0.848 | 0.724 | 0.714   |
| 1_6                     | 0.495     | 0.850 | 0.846 | 0.709 | 0.725   |
| 1_7                     | 0.446     | 0.849 | 0.821 | 0.726 | 0.711   |
| 1_8                     | 0.435     | 0.847 | 0.857 | 0.726 | 0.716   |
| 1_9                     | 0.474     | 0.858 | 0.839 | 0.728 | 0.725   |
| 1_10                    | 0.463     | 0.858 | 0.842 | 0.720 | 0.721   |

| support>0.6+projector128 | aeroplane | cat   | cow   | sheep | Mean AP |
| ------------------------ | --------- | ----- | ----- | ----- | ------- |
| 1_1                      | 0.464     | 0.708 | 0.724 | 0.592 | 0.622   |
| 1_2                      | 0.373     | 0.776 | 0.775 | 0.667 | 0.648   |
| 1_3                      | 0.439     | 0.783 | 0.759 | 0.645 | 0.656   |
| 1_4                      | 0.423     | 0.757 | 0.766 | 0.701 | 0.662   |
| 1_5                      | 0.459     | 0.848 | 0.836 | 0.719 | 0.716   |
| 1_6                      | 0.445     | 0.844 | 0.852 | 0.736 | 0.719   |
| 1_7                      | 0.433     | 0.862 | 0.851 | 0.746 | 0.723   |
| 1_8                      | 0.477     | 0.864 | 0.850 | 0.747 | 0.735   |
| 1_9                      | 0.473     | 0.853 | 0.836 | 0.743 | 0.726   |
| 1_10                     | 0.436     | 0.857 | 0.844 | 0.737 | 0.718   |

| support>0.6+projector512 | aeroplane | cat   | cow   | sheep | Mean AP |
| ------------------------ | --------- | ----- | ----- | ----- | ------- |
| 1_1                      | 0.371     | 0.612 | 0.576 | 0.537 | 0.524   |
| 1_2                      | 0.457     | 0.748 | 0.739 | 0.609 | 0.638   |
| 1_3                      | 0.416     | 0.802 | 0.790 | 0.653 | 0.665   |
| 1_4                      | 0.518     | 0.778 | 0.831 | 0.673 | 0.700   |
| 1_5                      | 0.460     | 0.841 | 0.840 | 0.730 | 0.718   |
| 1_6                      | 0.493     | 0.843 | 0.842 | 0.714 | 0.723   |
| 1_7                      | 0.467     | 0.847 | 0.850 | 0.746 | 0.728   |
| 1_8                      | 0.505     | 0.847 | 0.841 | 0.711 | 0.726   |
| 1_9                      | 0.447     | 0.838 | 0.854 | 0.744 | 0.720   |
| 1_10                     | 0.466     | 0.854 | 0.837 | 0.735 | 0.723   |

| support>0.5+projector64 | aeroplane | cat   | cow   | sheep | Mean AP |
| ----------------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1                     | 0.394     | 0.737 | 0.759 | 0.626 | 0.629   |
| 1_2                     | 0.324     | 0.731 | 0.737 | 0.665 | 0.615   |
| 1_3                     | 0.478     | 0.790 | 0.780 | 0.638 | 0.671   |
| 1_4                     | 0.396     | 0.801 | 0.819 | 0.719 | 0.683   |
| 1_5                     | 0.433     | 0.847 | 0.849 | 0.717 | 0.711   |
| 1_6                     | 0.462     | 0.865 | 0.846 | 0.720 | 0.723   |
| 1_7                     | 0.451     | 0.854 | 0.858 | 0.745 | 0.727   |
| 1_8                     | 0.453     | 0.858 | 0.842 | 0.731 | 0.721   |
| 1_9                     | 0.504     | 0.855 | 0.856 | 0.731 | 0.737   |
| 1_10                    | 0.458     | 0.854 | 0.863 | 0.746 | 0.730   |

| support>0.5+projector128 | aeroplane | cat   | cow   | sheep | Mean AP |
| ------------------------ | --------- | ----- | ----- | ----- | ------- |
| 1_1                      | 0.415     | 0.667 | 0.730 | 0.635 | 0.612   |
| 1_2                      | 0.367     | 0.801 | 0.789 | 0.658 | 0.654   |
| 1_3                      | 0.380     | 0.834 | 0.765 | 0.665 | 0.661   |
| 1_4                      | 0.391     | 0.822 | 0.796 | 0.716 | 0.681   |
| 1_5                      | 0.460     | 0.858 | 0.842 | 0.740 | 0.725   |
| 1_6                      | 0.406     | 0.855 | 0.864 | 0.735 | 0.715   |
| 1_7                      | 0.451     | 0.849 | 0.838 | 0.741 | 0.720   |
| 1_8                      | 0.394     | 0.857 | 0.850 | 0.741 | 0.711   |
| 1_9                      | 0.456     | 0.859 | 0.837 | 0.716 | 0.717   |
| 1_10                     | 0.443     | 0.862 | 0.844 | 0.739 | 0.722   |

| support>0.5+projector512 | aeroplane | cat   | cow   | sheep | Mean AP |
| ------------------------ | --------- | ----- | ----- | ----- | ------- |
| 1_1                      | 0.428     | 0.699 | 0.737 | 0.597 | 0.615   |
| 1_2                      | 0.503     | 0.720 | 0.736 | 0.628 | 0.647   |
| 1_3                      | 0.481     | 0.780 | 0.803 | 0.664 | 0.682   |
| 1_4                      | 0.509     | 0.803 | 0.788 | 0.729 | 0.707   |
| 1_5                      | 0.454     | 0.843 | 0.841 | 0.726 | 0.716   |
| 1_6                      | 0.511     | 0.844 | 0.839 | 0.722 | 0.729   |
| 1_7                      | 0.504     | 0.853 | 0.843 | 0.745 | 0.736   |
| 1_8                      | 0.442     | 0.849 | 0.849 | 0.746 | 0.721   |
| 1_9                      | 0.492     | 0.860 | 0.827 | 0.740 | 0.730   |
| 1_10                     | 0.450     | 0.865 | 0.845 | 0.738 | 0.724   |

| projector64+loss | aeroplane | cat   | cow   | sheep | Mean AP |
| ---------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1              | 0.420     | 0.554 | 0.590 | 0.515 | 0.520   |
| 1_2              | 0.454     | 0.779 | 0.793 | 0.640 | 0.666   |
| 1_3              | 0.301     | 0.820 | 0.808 | 0.723 | 0.663   |
| 1_4              | 0.416     | 0.761 | 0.791 | 0.658 | 0.657   |
| 1_5              | 0.473     | 0.831 | 0.829 | 0.702 | 0.709   |
| 1_6              | 0.479     | 0.849 | 0.852 | 0.731 | 0.728   |
| 1_7              | 0.453     | 0.851 | 0.862 | 0.739 | 0.726   |
| 1_8              | 0.427     | 0.844 | 0.845 | 0.740 | 0.714   |
| 1_9              | 0.461     | 0.841 | 0.845 | 0.753 | 0.725   |
| 1_10             | 0.461     | 0.850 | 0.857 | 0.755 | 0.731   |

| projector128+loss | aeroplane | cat   | cow   | sheep | Mean AP |
| ----------------- | --------- | ----- | ----- | ----- | ------- |
| 1_6               | 0.488     | 0.837 | 0.844 | 0.729 | 0.724   |
| 1_7               | 0.525     | 0.855 | 0.858 | 0.737 | 0.744   |
| 1_8               | 0.480     | 0.851 | 0.853 | 0.745 | 0.732   |
| 1_9               | 0.441     | 0.849 | 0.854 | 0.735 | 0.720   |
| 1_10              | 0.441     | 0.854 | 0.851 | 0.749 | 0.724   |

| projector512+loss | aeroplane | cat   | cow   | sheep | Mean AP |
| ----------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1               | 0.346     | 0.677 | 0.689 | 0.552 | 0.566   |
| 1_2               | 0.445     | 0.800 | 0.766 | 0.636 | 0.662   |
| 1_3               | 0.311     | 0.804 | 0.828 | 0.712 | 0.664   |
| 1_4               | 0.415     | 0.802 | 0.817 | 0.672 | 0.677   |
| 1_5               | 0.462     | 0.843 | 0.828 | 0.710 | 0.711   |
| 1_6               | 0.482     | 0.854 | 0.860 | 0.723 | 0.730   |
| 1_7               | 0.474     | 0.843 | 0.824 | 0.720 | 0.715   |
| 1_8               | 0.444     | 0.856 | 0.836 | 0.713 | 0.712   |
| 1_9               | 0.465     | 0.845 | 0.833 | 0.734 | 0.719   |
| 1_10              | 0.446     | 0.857 | 0.853 | 0.724 | 0.720   |

| 互换0.2+projector128+loss | aeroplane | cat   | cow   | sheep | Mean AP |
| ------------------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1                       | 0.370     | 0.648 | 0.708 | 0.587 | 0.578   |
| 1_2                       | 0.364     | 0.708 | 0.691 | 0.602 | 0.591   |
| 1_3                       | 0.376     | 0.746 | 0.820 | 0.704 | 0.662   |
| 1_4                       | 0.415     | 0.805 | 0.816 | 0.669 | 0.676   |
| 1_5                       | 0.461     | 0.832 | 0.857 | 0.716 | 0.717   |
| 1_6                       | 0.433     | 0.844 | 0.856 | 0.737 | 0.718   |
| 1_7                       | 0.462     | 0.839 | 0.850 | 0.724 | 0.719   |
| 1_8                       | 0.419     | 0.853 | 0.853 | 0.742 | 0.717   |
| 1_9                       | 0.407     | 0.839 | 0.841 | 0.746 | 0.708   |
| 1_10                      | 0.453     | 0.848 | 0.856 | 0.740 | 0.724   |

| support>0.5+projector128+loss | aeroplane | cat   | cow   | sheep | Mean AP |
| ----------------------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1                           | 0.347     | 0.586 | 0.726 | 0.636 | 0.574   |
| 1_2                           | 0.434     | 0.761 | 0.799 | 0.642 | 0.659   |
| 1_3                           | 0.452     | 0.797 | 0.767 | 0.668 | 0.671   |
| 1_4                           | 0.357     | 0.762 | 0.791 | 0.707 | 0.654   |
| 1_5                           | 0.452     | 0.830 | 0.826 | 0.731 | 0.710   |
| 1_6                           | 0.449     | 0.841 | 0.836 | 0.734 | 0.715   |
| 1_7                           | 0.397     | 0.840 | 0.854 | 0.737 | 0.707   |
| 1_8                           | 0.446     | 0.844 | 0.843 | 0.740 | 0.718   |
| 1_9                           | 0.447     | 0.847 | 0.826 | 0.742 | 0.716   |
| 1_10                          | 0.443     | 0.847 | 0.850 | 0.741 | 0.720   |



| support>0.5 | aeroplane | cat   | cow   | sheep | Mean AP |
| ----------- | --------- | ----- | ----- | ----- | ------- |
| 1_1         | 0.452     | 0.657 | 0.734 | 0.588 | 0.608   |
| 1_2         | 0.328     | 0.786 | 0.808 | 0.710 | 0.658   |
| 1_3         | 0.407     | 0.741 | 0.776 | 0.686 | 0.653   |
| 1_4         | 0.433     | 0.762 | 0.835 | 0.725 | 0.689   |
| 1_5         | 0.509     | 0.827 | 0.847 | 0.730 | 0.728   |
| 1_6         | 0.506     | 0.840 | 0.847 | 0.740 | 0.733   |
| 1_7         | 0.502     | 0.844 | 0.862 | 0.745 | 0.738   |
| 1_8         | 0.538     | 0.846 | 0.851 | 0.741 | 0.744   |
| 1_9         | 0.483     | 0.830 | 0.841 | 0.736 | 0.722   |
| 1_10        | 0.490     | 0.845 | 0.854 | 0.742 | 0.733   |

| support>0.6 | aeroplane | cat  | cow  | sheep | Mean AP |
| ---- | --------- | ---- | ---- | ----- | ------- |
| 1_1 | 0.342 | 0.619 | 0.634 | 0.538 | 0.533 |
| 1_2 | 0.388 | 0.768 | 0.807 | 0.642 | 0.651 |
| 1_3 | 0.449 | 0.781 | 0.785 | 0.653 | 0.667 |
| 1_4 | 0.404 | 0.800 | 0.787 | 0.712 | 0.676 |
| 1_5 | 0.503 | 0.856 | 0.842 | 0.719 | 0.730 |
| 1_6 | 0.529 | 0.852 | 0.829 | 0.711 | 0.730 |
| 1_7 | 0.487 | 0.853 | 0.836 | 0.726 | 0.726 |
| 1_8 | 0.486 | 0.859 | 0.863 | 0.734 | 0.735 |
| 1_9 | 0.525 | 0.850 | 0.828 | 0.716 | 0.730 |
| 1_10 | 0.478 | 0.853 | 0.842 | 0.750 | 0.731 |

| support>0.7 | aeroplane | cat   | cow   | sheep | Mean AP |
| ----------- | --------- | ----- | ----- | ----- | ------- |
| 1_1         | 0.356     | 0.619 | 0.726 | 0.560 | 0.565   |
| 1_2         | 0.320     | 0.734 | 0.708 | 0.694 | 0.614   |
| 1_3         | 0.398     | 0.772 | 0.797 | 0.703 | 0.667   |
| 1_4         | 0.530     | 0.822 | 0.835 | 0.688 | 0.719   |
| 1_5         | 0.486     | 0.845 | 0.848 | 0.718 | 0.724   |
| 1_6         | 0.424     | 0.855 | 0.857 | 0.735 | 0.718   |
| 1_7         | 0.460     | 0.853 | 0.839 | 0.696 | 0.712   |
| 1_8         | 0.519     | 0.859 | 0.845 | 0.723 | 0.737   |
| 1_9         | 0.441     | 0.857 | 0.867 | 0.741 | 0.727   |
| 1_10        | 0.447     | 0.849 | 0.870 | 0.730 | 0.724   |

| crop>0.5 | aeroplane | cat   | cow   | sheep | Mean AP |
| -------- | --------- | ----- | ----- | ----- | ------- |
| 1_1      | 0.418     | 0.661 | 0.700 | 0.635 | 0.604   |
| 1_2      | 0.298     | 0.741 | 0.745 | 0.677 | 0.616   |
| 1_3      | 0.411     | 0.799 | 0.798 | 0.689 | 0.674   |
| 1_4      | 0.445     | 0.795 | 0.761 | 0.661 | 0.665   |
| 1_5      | 0.446     | 0.822 | 0.815 | 0.723 | 0.701   |
| 1_6      | 0.476     | 0.845 | 0.842 | 0.715 | 0.719   |
| 1_7      | 0.466     | 0.837 | 0.823 | 0.713 | 0.710   |
| 1_8      | 0.413     | 0.848 | 0.828 | 0.728 | 0.704   |
| 1_9      | 0.450     | 0.848 | 0.837 | 0.709 | 0.711   |
| 1_10     | 0.450     | 0.837 | 0.855 | 0.719 | 0.715   |

| crop>0.6 | aeroplane | cat  | cow  | sheep | Mean AP |
| ---- | --------- | ---- | ---- | ----- | ------- |
| 1_1 | 0.314 | 0.740 | 0.738 | 0.651 | 0.611 |
| 1_2 | 0.377 | 0.827 | 0.813 | 0.684 | 0.675 |
| 1_3 | 0.466 | 0.758 | 0.812 | 0.645 | 0.670 |
| 1_4 | 0.569 | 0.803 | 0.754 | 0.614 | 0.685 |
| 1_5 | 0.472 | 0.833 | 0.851 | 0.698 | 0.713 |
| 1_6 | 0.482 | 0.846 | 0.847 | 0.729 | 0.726 |
| 1_7 | 0.434 | 0.858 | 0.851 | 0.735 | 0.719 |
| 1_8 | 0.487 | 0.856 | 0.857 | 0.737 | 0.734 |
| 1_9 | 0.487 | 0.857 | 0.860 | 0.725 | 0.732 |
| 1_10 | 0.440 | 0.855 | 0.866 | 0.745 | 0.726 |

| crop>0.7 | aeroplane | cat  | cow  | sheep | Mean AP |
| ---- | --------- | ---- | ---- | ----- | ------- |
| 1_1 | 0.429 | 0.628 | 0.715 | 0.576 | 0.587 |
| 1_2 | 0.301 | 0.744 | 0.796 | 0.699 | 0.635 |
| 1_3 | 0.424 | 0.765 | 0.796 | 0.654 | 0.660 |
| 1_4 | 0.426 | 0.760 | 0.802 | 0.675 | 0.666 |
| 1_5 | 0.478 | 0.836 | 0.827 | 0.700 | 0.710 |
| 1_6 | 0.472 | 0.840 | 0.851 | 0.727 | 0.722 |
| 1_7 | 0.465 | 0.840 | 0.846 | 0.729 | 0.720 |
| 1_8 | 0.495 | 0.847 | 0.833 | 0.715 | 0.723 |
| 1_9 | 0.499 | 0.853 | 0.818 | 0.717 | 0.722 |
| 1_10 | 0.489 | 0.854 | 0.834 | 0.705 | 0.721 |

| projector 64 | aeroplane | cat   | cow   | sheep | Mean AP |
| ------------ | --------- | ----- | ----- | ----- | ------- |
| 1_1          | 0.312     | 0.636 | 0.709 | 0.614 | 0.567   |
| 1_2          | 0.481     | 0.731 | 0.787 | 0.624 | 0.656   |
| 1_3          | 0.450     | 0.775 | 0.765 | 0.610 | 0.650   |
| 1_4          | 0.421     | 0.813 | 0.820 | 0.716 | 0.693   |
| 1_5          | 0.460     | 0.846 | 0.843 | 0.722 | 0.718   |
| 1_6          | 0.464     | 0.861 | 0.856 | 0.745 | 0.731   |
| 1_7          | 0.419     | 0.850 | 0.855 | 0.752 | 0.719   |
| 1_8          | 0.467     | 0.855 | 0.852 | 0.752 | 0.732   |
| 1_9          | 0.436     | 0.846 | 0.843 | 0.728 | 0.713   |
| 1_10         | 0.471     | 0.851 | 0.859 | 0.732 | 0.728   |

| projector 128 | aeroplane | cat   | cow   | sheep | Mean AP |
| ------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1           | 0.531     | 0.644 | 0.682 | 0.561 | 0.605   |
| 1_2           | 0.363     | 0.779 | 0.766 | 0.703 | 0.653   |
| 1_3           | 0.421     | 0.796 | 0.765 | 0.702 | 0.671   |
| 1_4           | 0.451     | 0.791 | 0.802 | 0.736 | 0.695   |
| 1_5           | 0.480     | 0.844 | 0.839 | 0.721 | 0.721   |
| 1_6           | 0.464     | 0.855 | 0.841 | 0.731 | 0.723   |
| 1_7           | 0.470     | 0.842 | 0.850 | 0.749 | 0.728   |
| 1_8           | 0.492     | 0.851 | 0.829 | 0.740 | 0.728   |
| 1_9           | 0.486     | 0.851 | 0.835 | 0.753 | 0.731   |
| 1_10          | 0.490     | 0.857 | 0.835 | 0.749 | 0.733   |

| projector 256 | aeroplane | cat   | cow   | sheep | Mean AP |
| ------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1           | 0.368     | 0.654 | 0.756 | 0.598 | 0.594   |
| 1_2           | 0.419     | 0.797 | 0.753 | 0.664 | 0.658   |
| 1_3           | 0.386     | 0.765 | 0.754 | 0.645 | 0.637   |
| 1_4           | 0.317     | 0.804 | 0.787 | 0.708 | 0.654   |
| 1_5           | 0.492     | 0.820 | 0.858 | 0.735 | 0.726   |
| 1_6           | 0.474     | 0.835 | 0.863 | 0.725 | 0.724   |
| 1_7           | 0.461     | 0.832 | 0.858 | 0.723 | 0.718   |
| 1_8           | 0.472     | 0.835 | 0.848 | 0.736 | 0.723   |
| 1_9           | 0.436     | 0.846 | 0.852 | 0.733 | 0.716   |
| 1_10          | 0.436     | 0.854 | 0.835 | 0.740 | 0.716   |

| projector 512 | aeroplane | cat   | cow   | sheep | Mean AP |
| ------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1           | 0.332     | 0.657 | 0.699 | 0.585 | 0.568   |
| 1_2           | 0.302     | 0.686 | 0.728 | 0.644 | 0.590   |
| 1_3           | 0.294     | 0.752 | 0.798 | 0.663 | 0.627   |
| 1_4           | 0.420     | 0.757 | 0.828 | 0.699 | 0.676   |
| 1_5           | 0.516     | 0.848 | 0.850 | 0.692 | 0.726   |
| 1_6           | 0.467     | 0.839 | 0.851 | 0.741 | 0.724   |
| 1_7           | 0.520     | 0.852 | 0.852 | 0.715 | 0.734   |
| 1_8           | 0.495     | 0.858 | 0.855 | 0.727 | 0.734   |
| 1_9           | 0.486     | 0.845 | 0.859 | 0.740 | 0.732   |
| 1_10          | 0.471     | 0.850 | 0.859 | 0.728 | 0.727   |

| projector 1024 | aeroplane | cat   | cow   | sheep | Mean AP |
| -------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1            | 0.429     | 0.620 | 0.692 | 0.582 | 0.581   |
| 1_2            | 0.446     | 0.767 | 0.820 | 0.697 | 0.683   |
| 1_3            | 0.435     | 0.755 | 0.786 | 0.708 | 0.671   |
| 1_4            | 0.389     | 0.788 | 0.731 | 0.683 | 0.648   |
| 1_5            | 0.460     | 0.834 | 0.838 | 0.717 | 0.712   |
| 1_6            | 0.464     | 0.847 | 0.846 | 0.728 | 0.721   |
| 1_7            | 0.484     | 0.848 | 0.843 | 0.720 | 0.724   |
| 1_8            | 0.484     | 0.858 | 0.839 | 0.730 | 0.728   |
| 1_9            | 0.449     | 0.839 | 0.852 | 0.731 | 0.718   |
| 1_10           | 0.458     | 0.856 | 0.848 | 0.723 | 0.721   |

| projector 2048 | aeroplane | cat   | cow   | sheep | Mean AP |
| -------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1            | 0.358     | 0.609 | 0.638 | 0.598 | 0.551   |
| 1_2            | 0.515     | 0.754 | 0.747 | 0.623 | 0.660   |
| 1_3            | 0.434     | 0.824 | 0.778 | 0.662 | 0.674   |
| 1_4            | 0.450     | 0.820 | 0.822 | 0.655 | 0.687   |
| 1_5            | 0.453     | 0.850 | 0.829 | 0.717 | 0.712   |
| 1_6            | 0.469     | 0.842 | 0.837 | 0.711 | 0.715   |
| 1_7            | 0.463     | 0.836 | 0.841 | 0.736 | 0.719   |
| 1_8            | 0.457     | 0.848 | 0.846 | 0.733 | 0.721   |
| 1_9            | 0.456     | 0.837 | 0.842 | 0.726 | 0.715   |
| 1_10           | 0.449     | 0.845 | 0.841 | 0.716 | 0.713   |

margin_loss = on_diag + self.lambd * off_diag

margin_loss = margin_loss * 0.000001

margin_loss = torch.sigmoid(margin_loss) * 0.1

| Barlow Twins *0.1 | aeroplane | cat   | cow   | sheep | Mean AP |
| ----------------- | --------- | ----- | ----- | ----- | ------- |
| 1_1               | 0.373     | 0.701 | 0.743 | 0.652 | 0.617   |
| 1_2               | 0.422     | 0.666 | 0.767 | 0.604 | 0.615   |
| 1_3               | 0.419     | 0.805 | 0.811 | 0.696 | 0.683   |
| 1_4               | 0.434     | 0.788 | 0.776 | 0.716 | 0.678   |
| 1_5               | 0.452     | 0.831 | 0.818 | 0.725 | 0.707   |
| 1_6               | 0.440     | 0.815 | 0.845 | 0.736 | 0.709   |
| 1_7               | 0.471     | 0.831 | 0.855 | 0.752 | 0.727   |
| 1_8               | 0.487     | 0.843 | 0.846 | 0.745 | 0.730   |
| 1_9               | 0.396     | 0.837 | 0.859 | 0.744 | 0.709   |
| 1_10              | 0.436     | 0.841 | 0.856 | 0.732 | 0.716   |


margin_loss = on_diag + self.lambd * off_diag

margin_loss = margin_loss * 0.000001

margin_loss = torch.sigmoid(margin_loss)

| Barlow Twins | aeroplane | cat   | cow   | sheep | Mean AP |
| ------------ | --------- | ----- | ----- | ----- | ------- |
| 1_1          | 0.353     | 0.701 | 0.715 | 0.621 | 0.598   |
| 1_2          | 0.414     | 0.725 | 0.723 | 0.620 | 0.621   |
| 1_3          | 0.445     | 0.810 | 0.816 | 0.716 | 0.697   |
| 1_4          | 0.436     | 0.806 | 0.817 | 0.699 | 0.689   |
| 1_5          | 0.449     | 0.844 | 0.849 | 0.728 | 0.718   |
| 1_6          | 0.450     | 0.865 | 0.833 | 0.742 | 0.723   |
| 1_7          | 0.441     | 0.851 | 0.842 | 0.752 | 0.722   |
| 1_8          | 0.501     | 0.864 | 0.836 | 0.761 | 0.740   |
| 1_9          | 0.467     | 0.869 | 0.835 | 0.760 | 0.733   |
| 1_10         | 0.466     | 0.863 | 0.856 | 0.751 | 0.734   |

| 目标互换0.1 | aeroplane | cat   | cow   | sheep | Mean AP |
| ----------- | --------- | ----- | ----- | ----- | ------- |
| 1_1         | 0.373     | 0.709 | 0.739 | 0.621 | 0.610   |
| 1_2         | 0.449     | 0.774 | 0.778 | 0.671 | 0.668   |
| 1_3         | 0.352     | 0.757 | 0.789 | 0.713 | 0.653   |
| 1_4         | 0.510     | 0.815 | 0.800 | 0.699 | 0.706   |
| 1_5         | 0.529     | 0.822 | 0.844 | 0.740 | 0.734   |
| 1_6         | 0.469     | 0.844 | 0.843 | 0.728 | 0.721   |
| 1_7         | 0.501     | 0.837 | 0.853 | 0.739 | 0.733   |
| 1_8         | 0.447     | 0.832 | 0.845 | 0.748 | 0.718   |
| 1_9         | 0.466     | 0.838 | 0.841 | 0.716 | 0.715   |
| 1_10        | 0.464     | 0.842 | 0.857 | 0.728 | 0.723   |

| 目标互换0.2 | aeroplane | cat       | cow       | sheep     | Mean AP   |
| ----------- | --------- | --------- | --------- | --------- | --------- |
| 1_1         | 0.409     | 0.715     | 0.704     | 0.611     | 0.610     |
| 1_2         | 0.495     | 0.750     | 0.753     | 0.631     | 0.657     |
| 1_3         | 0.472     | 0.787     | 0.770     | 0.645     | 0.669     |
| 1_4         | 0.477     | 0.742     | 0.802     | 0.691     | 0.678     |
| 1_5         | 0.521     | 0.841     | 0.831     | 0.713     | 0.727     |
| 1_6         | 0.501     | 0.849     | 0.844     | 0.689     | 0.721     |
| 1_7         | 0.468     | 0.849     | 0.839     | 0.713     | 0.717     |
| 1_8         | 0.532     | 0.834     | 0.827     | 0.727     | 0.730     |
| 1_9         | 0.475     | 0.860     | 0.860     | 0.713     | 0.727     |
| 1_10        | **0.498** | **0.851** | **0.857** | **0.733** | **0.735** |

| 目标互换0.3+p512 | aeroplane | cat       | cow       | sheep     | Mean AP   |
| ---------------- | --------- | --------- | --------- | --------- | --------- |
| 1_1              | 0.404     | 0.744     | 0.761     | 0.637     | 0.636     |
| 1_2              | 0.425     | 0.735     | 0.702     | 0.628     | 0.622     |
| 1_3              | 0.462     | 0.775     | 0.816     | 0.648     | 0.675     |
| 1_4              | 0.439     | 0.806     | 0.805     | 0.661     | 0.678     |
| 1_5              | 0.501     | 0.827     | 0.799     | 0.702     | 0.707     |
| 1_6              | 0.523     | 0.832     | 0.840     | 0.705     | 0.725     |
| 1_7              | 0.462     | 0.824     | 0.828     | 0.713     | 0.707     |
| 1_8              | 0.450     | 0.846     | 0.851     | 0.726     | 0.718     |
| 1_9              | 0.520     | 0.831     | 0.845     | 0.718     | 0.729     |
| 1_10             | **0.503** | **0.846** | **0.830** | **0.729** | **0.727** |
| 1_11             | 0.501     | 0.851     | 0.833     | 0.727     | 0.728     |

| 目标互换0.3+p128 | aeroplane | cat       | cow       | sheep     | Mean AP   |
| ---------------- | --------- | --------- | --------- | --------- | --------- |
| 1_1              | 0.362     | 0.693     | 0.733     | 0.606     | 0.599     |
| 1_2              | 0.297     | 0.746     | 0.791     | 0.689     | 0.631     |
| 1_3              | 0.466     | 0.745     | 0.779     | 0.644     | 0.659     |
| 1_4              | 0.506     | 0.787     | 0.820     | 0.653     | 0.691     |
| 1_5              | 0.500     | 0.841     | 0.830     | 0.702     | 0.718     |
| 1_6              | 0.478     | 0.841     | 0.830     | 0.712     | 0.715     |
| 1_7              | 0.487     | 0.839     | 0.856     | 0.716     | 0.725     |
| 1_8              | 0.503     | 0.830     | 0.844     | 0.695     | 0.718     |
| 1_9              | 0.498     | 0.841     | 0.854     | 0.711     | 0.726     |
| 1_10             | **0.479** | **0.847** | **0.867** | **0.691** | **0.721** |
| 1_11             | 0.499     | 0.851     | 0.860     | 0.697     | 0.727     |
| 1_12             | 0.474     | 0.848     | 0.854     | 0.731     | 0.727     |
| 1_13             | 0.490     | 0.846     | 0.857     | 0.711     | 0.726     |

| 目标互换0.3 | aeroplane | cat       | cow       | sheep     | Mean AP   |
| ----------- | --------- | --------- | --------- | --------- | --------- |
| 1_1         | 0.349     | 0.747     | 0.702     | 0.637     | 0.609     |
| 1_2         | 0.448     | 0.713     | 0.736     | 0.658     | 0.639     |
| 1_3         | 0.366     | 0.808     | 0.754     | 0.703     | 0.658     |
| 1_4         | 0.494     | 0.836     | 0.798     | 0.664     | 0.698     |
| 1_5         | 0.478     | 0.835     | 0.801     | 0.715     | 0.707     |
| 1_6         | 0.489     | 0.836     | 0.816     | 0.725     | 0.717     |
| 1_7         | 0.484     | 0.828     | 0.813     | 0.719     | 0.711     |
| 1_8         | 0.495     | 0.834     | **0.847** | 0.725     | 0.725     |
| 1_9         | **0.512** | 0.844     | 0.800     | 0.725     | 0.720     |
| 1_10        | **0.504** | **0.845** | **0.819** | **0.745** | **0.728** |
| 1_11        | 0.483     | 0.837     | 0.834     | 0.729     | 0.721     |
| 1_12        | 0.488     | 0.838     | 0.837     | 0.738     | 0.725     |
| 1_13        | 0.474     | 0.842     | 0.832     | 0.743     | 0.723     |
| 1_14        | 0.491     | **0.847** | 0.841     | 0.737     | 0.729     |
| 1_15        | 0.498     | 0.843     | 0.833     | 0.741     | 0.729     |
| 1_16        | 0.498     | 0.842     | 0.834     | 0.742     | 0.729     |
| 1_17        | 0.492     | 0.838     | 0.841     | 0.742     | 0.728     |
| 1_18        | 0.494     | 0.843     | 0.836     | **0.746** | **0.730** |
| 1_19        | 0.487     | 0.842     | 0.834     | 0.741     | 0.726     |
| 1_20        | 0.493     | 0.843     | 0.834     | 0.742     | 0.728     |

| 目标互换0.4 | aeroplane | cat       | cow       | sheep     | Mean AP   |
| ----------- | --------- | --------- | --------- | --------- | --------- |
| 1_1         | 0.453     | 0.619     | 0.647     | 0.531     | 0.563     |
| 1_2         | 0.400     | 0.566     | 0.713     | 0.571     | 0.562     |
| 1_3         | 0.455     | 0.807     | 0.766     | 0.622     | 0.662     |
| 1_4         | 0.496     | 0.719     | 0.794     | 0.661     | 0.667     |
| 1_5         | 0.473     | 0.822     | 0.831     | 0.701     | 0.707     |
| 1_6         | 0.512     | 0.819     | 0.827     | 0.710     | 0.717     |
| 1_7         | 0.484     | 0.842     | 0.829     | 0.732     | 0.722     |
| 1_8         | 0.483     | 0.844     | 0.839     | 0.738     | 0.726     |
| 1_9         | 0.488     | 0.827     | 0.833     | 0.716     | 0.716     |
| 1_10        | **0.480** | **0.836** | **0.838** | **0.727** | **0.720** |
| 1_11        | 0.478     | 0.842     | 0.831     | 0.739     | 0.722     |
| 1_12        | 0.501     | 0.835     | 0.839     | 0.727     | 0.725     |
| 1_13        | 0.508     | 0.838     | 0.844     | 0.730     | 0.730     |
| 1_14        | 0.486     | 0.848     | 0.840     | 0.739     | 0.728     |

| 目标互换0.5 | aeroplane | cat       | cow       | sheep     | Mean AP   |
| ----------- | --------- | --------- | --------- | --------- | --------- |
| 1_1         | 0.385     | 0.681     | 0.681     | 0.576     | 0.580     |
| 1_2         | 0.350     | 0.703     | 0.722     | 0.637     | 0.603     |
| 1_3         | 0.484     | 0.738     | 0.766     | 0.691     | 0.670     |
| 1_4         | 0.420     | 0.796     | 0.765     | 0.665     | 0.662     |
| 1_5         | 0.471     | 0.820     | 0.770     | 0.712     | 0.693     |
| 1_6         | 0.471     | 0.823     | 0.833     | 0.720     | 0.712     |
| 1_7         | 0.436     | 0.830     | 0.829     | 0.708     | 0.701     |
| 1_8         | 0.446     | 0.831     | 0.824     | 0.718     | 0.705     |
| 1_9         | 0.459     | 0.832     | **0.850** | 0.728     | 0.717     |
| 1_10        | **0.461** | **0.831** | **0.841** | **0.725** | **0.715** |
| 1_11        | 0.486     | 0.827     | 0.844     | **0.732** | 0.722     |
| 1_12        | 0.477     | 0.834     | 0.846     | 0.730     | 0.722     |
| 1_13        | 0.474     | 0.829     | 0.844     | 0.715     | 0.715     |
| 1_14        | **0.494** | 0.827     | 0.848     | 0.726     | **0.724** |
| 1_15        | 0.482     | 0.830     | 0.842     | 0.728     | 0.720     |
| 1_16        | 0.479     | 0.836     | 0.842     | 0.719     | 0.719     |
| 1_17        | 0.471     | 0.831     | 0.839     | 0.728     | 0.717     |
| 1_18        | 0.482     | **0.837** | 0.842     | 0.715     | 0.719     |
| 1_19        | 0.484     | 0.829     | 0.844     | 0.719     | 0.719     |
| 1_20        | 0.482     | 0.828     | 0.844     | 0.717     | 0.718     |

| 初始训练 | aeroplane  | cat        | cow        | sheep      | Mean AP   |
| -------- | ---------- | ---------- | ---------- | ---------- | --------- |
| 1_1      | 0.4136     | 0.637      | 0.6926     | 0.5967     | 0.585     |
| 1_2      | 0.3654     | 0.7478     | 0.7473     | 0.6706     | 0.633     |
| 1_3      | 0.4405     | 0.7762     | 0.801      | 0.6588     | 0.669     |
| 1_4      | 0.4353     | 0.833      | 0.8188     | 0.661      | 0.687     |
| 1_5      | **0.5016** | 0.8369     | 0.8236     | 0.733      | 0.724     |
| 1_6      | 0.4516     | 0.8356     | 0.8463     | 0.7237     | 0.714     |
| 1_7      | 0.4668     | 0.8426     | 0.8392     | 0.7121     | 0.715     |
| 1_8      | 0.4824     | 0.8467     | 0.8404     | 0.7178     | 0.722     |
| 1_9      | 0.4119     | 0.8444     | 0.8576     | **0.7537** | 0.717     |
| 1_10     | **0.4577** | **0.8487** | **0.8548** | **0.7345** | **0.724** |
| 1_11     | 0.4606     | 0.8443     | 0.8484     | 0.7335     | 0.722     |
| 1_12     | 0.4481     | 0.8457     | 0.8198     | 0.7434     | 0.714     |
| 1_13     | 0.4741     | 0.8445     | **0.8686** | 0.7282     | **0.729** |
| 1_14     | 0.4309     | 0.8412     | 0.8594     | 0.7409     | 0.718     |
| 1_15     | 0.4397     | **0.851**  | 0.8618     | 0.7397     | 0.723     |
| 1_16     | 0.4505     | 0.8454     | 0.8604     | 0.7366     | 0.723     |
| 1_17     | 0.4432     | 0.8487     | 0.8593     | 0.7405     | 0.723     |
| 1_18     | 0.4408     | 0.8482     | 0.8583     | 0.7471     | 0.724     |
| 1_19     | 0.4464     | 0.8475     | 0.8595     | 0.7483     | 0.725     |
| 1_20     | 0.4405     | 0.8486     | 0.8484     | 0.7452     | 0.72      |



## COCO数据集

|                            | Epoch 10 | Max   |
| -------------------------- | -------- | ----- |
| 原代码                     | 0.232    | 0.238 |
|                            |          |       |
| 目标互换0.5                | 0.241    | 0.246 |
|                            |          |       |
| 目标互换0.5+projector 64   | 0.245    | 0.245 |
| 目标互换0.5+projector 128  | 0.247    | 0.252 |
| 目标互换0.5+projector 256  | 0.237    | 0.241 |
| 目标互换0.5+projector 512  | 0.248    | 0.248 |
| 目标互换0.5+projector 1024 |          |       |
| 目标互换0.5+projector 2048 | 0.241    | 0.243 |
|                            |          |       |
| 不互换+Loss Barlow Twins   | 0.242    | 0.245 |
|                            |          |       |
| support p > 0.5            | 0.241    | 0.241 |
| crop p > 0.5               |          |       |

| 互换 | p128  | loss  |       |       |       |       |       |       |       |       |       |       |
| ---- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1  | 0.086 | 0.184 | 0.075 | 0.057 | 0.112 | 0.140 | 0.103 | 0.242 | 0.271 | 0.152 | 0.307 | 0.415 |
| 1_2  | 0.094 | 0.193 | 0.083 | 0.043 | 0.108 | 0.151 | 0.113 | 0.245 | 0.282 | 0.160 | 0.303 | 0.447 |
| 1_3  | 0.107 | 0.213 | 0.095 | 0.058 | 0.115 | 0.160 | 0.121 | 0.264 | 0.298 | 0.187 | 0.329 | 0.448 |
| 1_4  | 0.109 | 0.214 | 0.103 | 0.064 | 0.128 | 0.166 | 0.120 | 0.272 | 0.308 | 0.172 | 0.341 | 0.461 |
| 1_5  | 0.125 | 0.232 | 0.120 | 0.089 | 0.140 | 0.190 | 0.133 | 0.292 | 0.330 | 0.204 | 0.360 | 0.490 |
| 1_6  | 0.133 | 0.245 | 0.130 | 0.093 | 0.149 | 0.205 | 0.145 | 0.294 | 0.328 | 0.202 | 0.362 | 0.483 |
| 1_7  | 0.135 | 0.247 | 0.131 | 0.089 | 0.150 | 0.205 | 0.139 | 0.291 | 0.328 | 0.204 | 0.359 | 0.484 |
| 1_8  | 0.122 | 0.234 | 0.114 | 0.062 | 0.138 | 0.182 | 0.135 | 0.283 | 0.322 | 0.199 | 0.357 | 0.469 |
| 1_9  | 0.130 | 0.236 | 0.126 | 0.086 | 0.133 | 0.207 | 0.142 | 0.294 | 0.331 | 0.204 | 0.361 | 0.490 |
| 1_10 | 0.135 | 0.245 | 0.131 | 0.087 | 0.146 | 0.213 | 0.144 | 0.294 | 0.333 | 0.201 | 0.371 | 0.489 |

| 互换 | p512  | loss  |       |       |       |       |       |       |       |       |       |       |
| ---- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_6  | 0.124 | 0.225 | 0.121 | 0.063 | 0.137 | 0.193 | 0.136 | 0.286 | 0.325 | 0.200 | 0.362 | 0.488 |
| 1_7  | 0.128 | 0.236 | 0.124 | 0.083 | 0.137 | 0.202 | 0.137 | 0.290 | 0.331 | 0.202 | 0.365 | 0.491 |
| 1_8  | 0.126 | 0.232 | 0.119 | 0.064 | 0.146 | 0.195 | 0.140 | 0.287 | 0.327 | 0.207 | 0.363 | 0.488 |
| 1_9  | 0.121 | 0.224 | 0.118 | 0.085 | 0.129 | 0.197 | 0.132 | 0.278 | 0.321 | 0.204 | 0.351 | 0.481 |
| 1_10 | 0.132 | 0.239 | 0.131 | 0.086 | 0.150 | 0.202 | 0.141 | 0.292 | 0.330 | 0.202 | 0.370 | 0.480 |

| support0.5 | p128  |       |       |       |       |       |       |       |       |       |       |       |
| ---------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_6        | 0.130 | 0.240 | 0.129 | 0.072 | 0.141 | 0.217 | 0.141 | 0.292 | 0.330 | 0.193 | 0.368 | 0.502 |
| 1_7        | 0.132 | 0.242 | 0.128 | 0.067 | 0.136 | 0.220 | 0.142 | 0.293 | 0.331 | 0.203 | 0.366 | 0.497 |
| 1_8        | 0.132 | 0.236 | 0.131 | 0.076 | 0.140 | 0.222 | 0.141 | 0.295 | 0.333 | 0.202 | 0.366 | 0.496 |
| 1_9        | 0.126 | 0.231 | 0.127 | 0.067 | 0.135 | 0.208 | 0.138 | 0.291 | 0.335 | 0.205 | 0.371 | 0.489 |
| 1_10       | 0.132 | 0.239 | 0.129 | 0.073 | 0.137 | 0.221 | 0.143 | 0.296 | 0.336 | 0.197 | 0.369 | 0.504 |

| support0.5 | p512  |       |       |       |       |       |       |       |       |       |       |       |
| ---------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_5        | 0.128 | 0.232 | 0.124 | 0.070 | 0.143 | 0.214 | 0.139 | 0.291 | 0.331 | 0.199 | 0.374 | 0.491 |
| 1_6        | 0.129 | 0.239 | 0.124 | 0.057 | 0.145 | 0.215 | 0.141 | 0.293 | 0.329 | 0.192 | 0.363 | 0.492 |
| 1_7        | 0.129 | 0.232 | 0.131 | 0.086 | 0.146 | 0.210 | 0.137 | 0.290 | 0.330 | 0.196 | 0.368 | 0.492 |
| 1_8        | 0.131 | 0.234 | 0.131 | 0.062 | 0.144 | 0.214 | 0.141 | 0.290 | 0.329 | 0.191 | 0.367 | 0.491 |
| 1_9        | 0.128 | 0.232 | 0.125 | 0.084 | 0.140 | 0.217 | 0.139 | 0.288 | 0.327 | 0.188 | 0.366 | 0.501 |
| 1_10       | 0.133 | 0.237 | 0.131 | 0.055 | 0.144 | 0.219 | 0.141 | 0.295 | 0.335 | 0.197 | 0.379 | 0.489 |

| support0.6 | p128  |       |       |       |       |       |       |       |       |       |       |       |
| ---------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1        | 0.094 | 0.199 | 0.078 | 0.049 | 0.114 | 0.146 | 0.107 | 0.236 | 0.270 | 0.146 | 0.312 | 0.421 |
| 1_2        | 0.116 | 0.226 | 0.109 | 0.057 | 0.131 | 0.176 | 0.125 | 0.264 | 0.300 | 0.166 | 0.344 | 0.456 |
| 1_3        | 0.111 | 0.220 | 0.103 | 0.063 | 0.125 | 0.168 | 0.127 | 0.270 | 0.303 | 0.146 | 0.339 | 0.473 |
| 1_4        | 0.100 | 0.195 | 0.092 | 0.049 | 0.114 | 0.163 | 0.118 | 0.261 | 0.298 | 0.149 | 0.333 | 0.455 |
| 1_5        | 0.129 | 0.239 | 0.125 | 0.060 | 0.134 | 0.225 | 0.139 | 0.292 | 0.327 | 0.177 | 0.355 | 0.494 |
| 1_6        | 0.138 | 0.250 | 0.135 | 0.066 | 0.151 | 0.227 | 0.147 | 0.291 | 0.328 | 0.166 | 0.367 | 0.497 |
| 1_7        | 0.129 | 0.236 | 0.128 | 0.057 | 0.130 | 0.207 | 0.139 | 0.291 | 0.332 | 0.184 | 0.366 | 0.495 |
| 1_8        | 0.127 | 0.229 | 0.126 | 0.054 | 0.136 | 0.210 | 0.139 | 0.287 | 0.332 | 0.201 | 0.359 | 0.497 |
| 1_9        | 0.132 | 0.233 | 0.134 | 0.062 | 0.136 | 0.214 | 0.142 | 0.290 | 0.330 | 0.200 | 0.362 | 0.496 |
| 1_10       | 0.130 | 0.233 | 0.127 | 0.081 | 0.135 | 0.221 | 0.139 | 0.292 | 0.334 | 0.195 | 0.368 | 0.504 |

| support0.6 | p512  |       |       |       |       |       |       |       |       |       |       |       |
| ---------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1        | 0.093 | 0.194 | 0.081 | 0.046 | 0.114 | 0.140 | 0.106 | 0.245 | 0.276 | 0.127 | 0.310 | 0.427 |
| 1_2        | 0.090 | 0.190 | 0.082 | 0.042 | 0.100 | 0.138 | 0.110 | 0.253 | 0.291 | 0.171 | 0.319 | 0.450 |
| 1_3        | 0.108 | 0.208 | 0.105 | 0.047 | 0.120 | 0.164 | 0.114 | 0.264 | 0.302 | 0.144 | 0.344 | 0.458 |
| 1_4        | 0.118 | 0.227 | 0.115 | 0.063 | 0.127 | 0.189 | 0.125 | 0.272 | 0.313 | 0.156 | 0.353 | 0.475 |
| 1_5        | 0.125 | 0.228 | 0.124 | 0.062 | 0.134 | 0.202 | 0.139 | 0.285 | 0.326 | 0.200 | 0.369 | 0.480 |
| 1_6        | 0.126 | 0.231 | 0.121 | 0.059 | 0.132 | 0.205 | 0.140 | 0.292 | 0.328 | 0.191 | 0.367 | 0.489 |
| 1_7        | 0.125 | 0.227 | 0.124 | 0.062 | 0.132 | 0.197 | 0.139 | 0.288 | 0.327 | 0.195 | 0.361 | 0.481 |
| 1_8        | 0.126 | 0.230 | 0.125 | 0.062 | 0.134 | 0.206 | 0.135 | 0.292 | 0.335 | 0.206 | 0.375 | 0.489 |
| 1_9        | 0.124 | 0.222 | 0.123 | 0.059 | 0.131 | 0.203 | 0.132 | 0.285 | 0.331 | 0.174 | 0.370 | 0.499 |
| 1_10       | 0.129 | 0.228 | 0.130 | 0.057 | 0.134 | 0.218 | 0.138 | 0.291 | 0.332 | 0.195 | 0.374 | 0.496 |

| support0.5 | p128  | loss*0.1 |       |       |       |       |       |       |       |       |       |       |
| ---------- | ----- | -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1        | 0.094 | 0.192    | 0.090 | 0.047 | 0.105 | 0.144 | 0.109 | 0.251 | 0.281 | 0.162 | 0.321 | 0.420 |
| 1_2        | 0.096 | 0.200    | 0.088 | 0.045 | 0.117 | 0.161 | 0.118 | 0.254 | 0.290 | 0.179 | 0.327 | 0.452 |
| 1_3        | 0.115 | 0.217    | 0.107 | 0.066 | 0.129 | 0.175 | 0.130 | 0.273 | 0.310 | 0.190 | 0.334 | 0.474 |
| 1_4        | 0.116 | 0.219    | 0.106 | 0.085 | 0.125 | 0.187 | 0.125 | 0.280 | 0.316 | 0.184 | 0.350 | 0.479 |
| 1_5        | 0.129 | 0.236    | 0.126 | 0.090 | 0.145 | 0.209 | 0.140 | 0.295 | 0.333 | 0.202 | 0.373 | 0.484 |
| 1_6        | 0.128 | 0.236    | 0.122 | 0.088 | 0.136 | 0.217 | 0.139 | 0.295 | 0.335 | 0.205 | 0.379 | 0.493 |
| 1_7        | 0.124 | 0.230    | 0.120 | 0.095 | 0.138 | 0.193 | 0.137 | 0.292 | 0.330 | 0.203 | 0.362 | 0.490 |
| 1_8        | 0.131 | 0.238    | 0.127 | 0.091 | 0.136 | 0.218 | 0.144 | 0.296 | 0.337 | 0.204 | 0.372 | 0.492 |
| 1_9        | 0.129 | 0.233    | 0.129 | 0.084 | 0.137 | 0.215 | 0.138 | 0.296 | 0.339 | 0.207 | 0.370 | 0.511 |
| 1_10       | 0.128 | 0.230    | 0.124 | 0.092 | 0.137 | 0.209 | 0.138 | 0.293 | 0.334 | 0.209 | 0.372 | 0.492 |

| support0.5 | p128  | loss*0.5 |       |       |       |       |       |       |       |       |       |       |
| ---------- | ----- | -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_2        | 0.105 | 0.208    | 0.094 | 0.084 | 0.114 | 0.169 | 0.121 | 0.258 | 0.290 | 0.168 | 0.324 | 0.445 |
| 1_3        | 0.105 | 0.210    | 0.097 | 0.053 | 0.129 | 0.155 | 0.119 | 0.269 | 0.309 | 0.167 | 0.357 | 0.448 |
| 1_4        | 0.113 | 0.216    | 0.113 | 0.064 | 0.122 | 0.188 | 0.125 | 0.273 | 0.308 | 0.184 | 0.339 | 0.459 |
| 1_5        | 0.129 | 0.235    | 0.127 | 0.065 | 0.140 | 0.200 | 0.136 | 0.292 | 0.334 | 0.218 | 0.368 | 0.495 |
| 1_6        | 0.138 | 0.244    | 0.139 | 0.066 | 0.147 | 0.229 | 0.145 | 0.297 | 0.334 | 0.220 | 0.364 | 0.509 |
| 1_7        | 0.136 | 0.245    | 0.132 | 0.066 | 0.149 | 0.220 | 0.142 | 0.298 | 0.335 | 0.218 | 0.369 | 0.505 |
| 1_8        | 0.137 | 0.245    | 0.136 | 0.067 | 0.148 | 0.228 | 0.145 | 0.302 | 0.338 | 0.219 | 0.369 | 0.510 |
| 1_9        | 0.133 | 0.241    | 0.127 | 0.076 | 0.144 | 0.225 | 0.138 | 0.296 | 0.339 | 0.213 | 0.380 | 0.507 |
| 1_10       | 0.130 | 0.239    | 0.126 | 0.057 | 0.144 | 0.217 | 0.140 | 0.294 | 0.336 | 0.220 | 0.374 | 0.507 |

| support0.5 | p128  | loss  |       |       |       |       |       |       |       |       |       |       |
| ---------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1        | 0.096 | 0.201 | 0.086 | 0.050 | 0.103 | 0.149 | 0.111 | 0.246 | 0.279 | 0.148 | 0.309 | 0.421 |
| 1_2        | 0.104 | 0.205 | 0.097 | 0.050 | 0.115 | 0.163 | 0.116 | 0.257 | 0.292 | 0.171 | 0.324 | 0.441 |
| 1_3        | 0.094 | 0.185 | 0.089 | 0.049 | 0.102 | 0.147 | 0.111 | 0.252 | 0.294 | 0.193 | 0.324 | 0.434 |
| 1_4        | 0.121 | 0.220 | 0.120 | 0.062 | 0.135 | 0.187 | 0.131 | 0.281 | 0.320 | 0.205 | 0.353 | 0.479 |
| 1_5        | 0.127 | 0.232 | 0.125 | 0.066 | 0.140 | 0.199 | 0.133 | 0.291 | 0.330 | 0.199 | 0.372 | 0.491 |
| 1_6        | 0.132 | 0.236 | 0.135 | 0.064 | 0.144 | 0.214 | 0.141 | 0.300 | 0.339 | 0.198 | 0.385 | 0.498 |
| 1_7        | 0.129 | 0.232 | 0.126 | 0.062 | 0.144 | 0.211 | 0.141 | 0.300 | 0.337 | 0.202 | 0.383 | 0.500 |
| 1_8        | 0.130 | 0.234 | 0.131 | 0.084 | 0.137 | 0.215 | 0.139 | 0.291 | 0.334 | 0.216 | 0.370 | 0.497 |
| 1_9        | 0.127 | 0.235 | 0.127 | 0.061 | 0.136 | 0.209 | 0.140 | 0.293 | 0.333 | 0.215 | 0.365 | 0.495 |
| 1_10       | 0.137 | 0.242 | 0.139 | 0.062 | 0.147 | 0.223 | 0.146 | 0.306 | 0.347 | 0.214 | 0.387 | 0.511 |

| support0.5 | p128  | loss*0.7 |       |       |       |       |       |       |       |       |       |       |
| ---------- | ----- | -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1        | 0.103 | 0.214    | 0.092 | 0.064 | 0.113 | 0.166 | 0.120 | 0.255 | 0.286 | 0.158 | 0.319 | 0.424 |
| 1_2        | 0.111 | 0.219    | 0.106 | 0.078 | 0.130 | 0.168 | 0.122 | 0.270 | 0.305 | 0.171 | 0.350 | 0.447 |
| 1_3        | 0.101 | 0.202    | 0.091 | 0.080 | 0.117 | 0.164 | 0.121 | 0.258 | 0.296 | 0.193 | 0.340 | 0.426 |
| 1_4        | 0.105 | 0.201    | 0.099 | 0.053 | 0.122 | 0.155 | 0.117 | 0.262 | 0.302 | 0.194 | 0.326 | 0.455 |
| 1_5        | 0.128 | 0.235    | 0.127 | 0.091 | 0.139 | 0.196 | 0.138 | 0.297 | 0.335 | 0.210 | 0.370 | 0.493 |
| 1_6        | 0.127 | 0.228    | 0.125 | 0.086 | 0.138 | 0.196 | 0.140 | 0.294 | 0.333 | 0.200 | 0.373 | 0.490 |
| 1_7        | 0.128 | 0.233    | 0.127 | 0.060 | 0.139 | 0.199 | 0.137 | 0.293 | 0.333 | 0.219 | 0.375 | 0.491 |
| 1_8        | 0.132 | 0.234    | 0.129 | 0.064 | 0.141 | 0.217 | 0.142 | 0.296 | 0.334 | 0.198 | 0.370 | 0.493 |
| 1_9        | 0.126 | 0.230    | 0.121 | 0.053 | 0.141 | 0.208 | 0.139 | 0.288 | 0.331 | 0.212 | 0.371 | 0.487 |
| 1_10       | 0.130 | 0.233    | 0.128 | 0.060 | 0.138 | 0.217 | 0.139 | 0.297 | 0.338 | 0.230 | 0.374 | 0.496 |

| support0.7 | p128  |       |       |       |       |       |       |       |       |       |       |       |
| ---------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1        | 0.096 | 0.203 | 0.084 | 0.057 | 0.122 | 0.143 | 0.109 | 0.247 | 0.276 | 0.150 | 0.307 | 0.420 |
| 1_2        | 0.098 | 0.197 | 0.088 | 0.056 | 0.109 | 0.153 | 0.112 | 0.248 | 0.280 | 0.178 | 0.302 | 0.421 |
| 1_3        | 0.115 | 0.227 | 0.108 | 0.051 | 0.123 | 0.186 | 0.127 | 0.268 | 0.301 | 0.177 | 0.338 | 0.468 |
| 1_4        | 0.108 | 0.205 | 0.099 | 0.051 | 0.124 | 0.167 | 0.118 | 0.257 | 0.304 | 0.180 | 0.339 | 0.453 |
| 1_5        | 0.129 | 0.242 | 0.125 | 0.057 | 0.144 | 0.203 | 0.139 | 0.287 | 0.327 | 0.192 | 0.368 | 0.487 |
| 1_6        | 0.126 | 0.236 | 0.123 | 0.061 | 0.142 | 0.202 | 0.133 | 0.287 | 0.328 | 0.194 | 0.362 | 0.480 |
| 1_7        | 0.131 | 0.242 | 0.129 | 0.060 | 0.141 | 0.209 | 0.139 | 0.289 | 0.330 | 0.207 | 0.365 | 0.492 |
| 1_8        | 0.134 | 0.244 | 0.129 | 0.062 | 0.134 | 0.230 | 0.144 | 0.293 | 0.333 | 0.202 | 0.364 | 0.505 |
| 1_9        | 0.132 | 0.241 | 0.131 | 0.062 | 0.145 | 0.212 | 0.136 | 0.299 | 0.338 | 0.200 | 0.379 | 0.503 |
| 1_10       | 0.134 | 0.240 | 0.135 | 0.059 | 0.137 | 0.227 | 0.139 | 0.291 | 0.333 | 0.188 | 0.366 | 0.499 |

| crop>0.7 | p128  |       |       |       |       |       |       |       |       |       |       |       |
| -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1      | 0.096 | 0.203 | 0.085 | 0.043 | 0.118 | 0.158 | 0.116 | 0.236 | 0.269 | 0.117 | 0.305 | 0.423 |
| 1_2      | 0.094 | 0.193 | 0.082 | 0.071 | 0.120 | 0.156 | 0.112 | 0.245 | 0.294 | 0.172 | 0.346 | 0.424 |
| 1_3      | 0.106 | 0.216 | 0.095 | 0.051 | 0.108 | 0.174 | 0.119 | 0.252 | 0.292 | 0.171 | 0.330 | 0.441 |
| 1_4      | 0.108 | 0.207 | 0.101 | 0.086 | 0.120 | 0.167 | 0.126 | 0.265 | 0.301 | 0.184 | 0.338 | 0.446 |
| 1_5      | 0.132 | 0.244 | 0.132 | 0.081 | 0.139 | 0.207 | 0.140 | 0.292 | 0.332 | 0.206 | 0.361 | 0.495 |
| 1_6      | 0.130 | 0.241 | 0.130 | 0.090 | 0.139 | 0.214 | 0.138 | 0.293 | 0.336 | 0.206 | 0.374 | 0.499 |
| 1_7      | 0.132 | 0.236 | 0.131 | 0.069 | 0.146 | 0.213 | 0.139 | 0.287 | 0.332 | 0.200 | 0.373 | 0.485 |
| 1_8      | 0.129 | 0.235 | 0.127 | 0.077 | 0.142 | 0.208 | 0.135 | 0.291 | 0.330 | 0.195 | 0.366 | 0.492 |
| 1_9      | 0.128 | 0.231 | 0.127 | 0.078 | 0.134 | 0.215 | 0.136 | 0.293 | 0.334 | 0.201 | 0.371 | 0.488 |
| 1_10     | 0.133 | 0.234 | 0.136 | 0.096 | 0.141 | 0.226 | 0.139 | 0.290 | 0.335 | 0.210 | 0.371 | 0.500 |

| crop>0.7 | p512  |       |       |       |       |       |       |       |       |       |       |       |
| -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1      | 0.093 | 0.195 | 0.083 | 0.048 | 0.112 | 0.147 | 0.109 | 0.237 | 0.270 | 0.169 | 0.309 | 0.392 |
| 1_2      | 0.095 | 0.193 | 0.088 | 0.061 | 0.098 | 0.158 | 0.115 | 0.246 | 0.283 | 0.173 | 0.313 | 0.420 |
| 1_3      | 0.105 | 0.208 | 0.099 | 0.053 | 0.112 | 0.155 | 0.118 | 0.266 | 0.306 | 0.157 | 0.342 | 0.453 |
| 1_4      | 0.106 | 0.202 | 0.099 | 0.052 | 0.117 | 0.157 | 0.119 | 0.263 | 0.296 | 0.144 | 0.321 | 0.448 |
| 1_5      | 0.131 | 0.232 | 0.131 | 0.058 | 0.145 | 0.206 | 0.142 | 0.287 | 0.326 | 0.182 | 0.369 | 0.493 |
| 1_6      | 0.126 | 0.228 | 0.124 | 0.058 | 0.140 | 0.200 | 0.136 | 0.291 | 0.333 | 0.170 | 0.370 | 0.502 |
| 1_7      | 0.133 | 0.234 | 0.135 | 0.057 | 0.141 | 0.221 | 0.140 | 0.292 | 0.333 | 0.163 | 0.378 | 0.496 |
| 1_8      | 0.130 | 0.230 | 0.131 | 0.055 | 0.143 | 0.212 | 0.137 | 0.288 | 0.330 | 0.167 | 0.368 | 0.487 |
| 1_9      | 0.129 | 0.230 | 0.128 | 0.055 | 0.142 | 0.201 | 0.136 | 0.292 | 0.330 | 0.167 | 0.369 | 0.485 |
| 1_10     | 0.134 | 0.236 | 0.133 | 0.057 | 0.144 | 0.213 | 0.142 | 0.289 | 0.332 | 0.168 | 0.374 | 0.488 |

| support>0.5 | loss  |       |       |       |       |       |       |       |       |       |       |       |
| ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1         | 0.094 | 0.194 | 0.085 | 0.053 | 0.102 | 0.145 | 0.117 | 0.248 | 0.288 | 0.190 | 0.327 | 0.426 |
| 1_2         | 0.106 | 0.208 | 0.097 | 0.075 | 0.120 | 0.158 | 0.118 | 0.263 | 0.303 | 0.171 | 0.339 | 0.452 |
| 1_3         | 0.108 | 0.202 | 0.104 | 0.052 | 0.112 | 0.182 | 0.118 | 0.259 | 0.300 | 0.150 | 0.325 | 0.449 |
| 1_4         | 0.112 | 0.212 | 0.107 | 0.059 | 0.135 | 0.176 | 0.129 | 0.273 | 0.315 | 0.171 | 0.352 | 0.466 |
| 1_5         | 0.132 | 0.238 | 0.133 | 0.064 | 0.144 | 0.211 | 0.142 | 0.299 | 0.341 | 0.206 | 0.383 | 0.498 |
| 1_6         | 0.130 | 0.238 | 0.130 | 0.066 | 0.139 | 0.216 | 0.140 | 0.300 | 0.338 | 0.203 | 0.373 | 0.505 |
| 1_7         | 0.131 | 0.237 | 0.128 | 0.070 | 0.144 | 0.215 | 0.137 | 0.295 | 0.340 | 0.218 | 0.375 | 0.500 |
| 1_8         | 0.134 | 0.238 | 0.135 | 0.064 | 0.142 | 0.222 | 0.145 | 0.300 | 0.342 | 0.202 | 0.382 | 0.506 |
| 1_9         | 0.131 | 0.233 | 0.134 | 0.086 | 0.140 | 0.212 | 0.140 | 0.297 | 0.342 | 0.208 | 0.385 | 0.496 |
| 1_10        | 0.130 | 0.235 | 0.130 | 0.087 | 0.136 | 0.219 | 0.143 | 0.296 | 0.339 | 0.209 | 0.372 | 0.504 |

| crop>0.7 | loss  |       |       |       |       |       |       |       |       |       |       |       |
| -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1      | 0.096 | 0.188 | 0.091 | 0.043 | 0.101 | 0.171 | 0.116 | 0.253 | 0.285 | 0.168 | 0.312 | 0.438 |
| 1_2      | 0.109 | 0.216 | 0.101 | 0.057 | 0.120 | 0.177 | 0.124 | 0.264 | 0.299 | 0.185 | 0.324 | 0.466 |
| 1_3      | 0.104 | 0.210 | 0.091 | 0.055 | 0.119 | 0.162 | 0.120 | 0.266 | 0.308 | 0.186 | 0.352 | 0.455 |
| 1_4      | 0.114 | 0.222 | 0.109 | 0.062 | 0.129 | 0.166 | 0.123 | 0.272 | 0.314 | 0.198 | 0.341 | 0.473 |
| 1_5      | 0.129 | 0.234 | 0.125 | 0.094 | 0.134 | 0.205 | 0.143 | 0.295 | 0.333 | 0.216 | 0.358 | 0.497 |
| 1_6      | 0.131 | 0.240 | 0.126 | 0.086 | 0.140 | 0.209 | 0.137 | 0.294 | 0.334 | 0.200 | 0.376 | 0.485 |
| 1_7      | 0.132 | 0.238 | 0.132 | 0.092 | 0.142 | 0.209 | 0.140 | 0.293 | 0.333 | 0.203 | 0.365 | 0.493 |
| 1_8      | 0.127 | 0.229 | 0.120 | 0.084 | 0.125 | 0.213 | 0.137 | 0.293 | 0.336 | 0.203 | 0.368 | 0.496 |
| 1_9      | 0.130 | 0.233 | 0.129 | 0.083 | 0.137 | 0.221 | 0.137 | 0.294 | 0.335 | 0.199 | 0.370 | 0.505 |
| 1_10     | 0.132 | 0.236 | 0.130 | 0.085 | 0.143 | 0.221 | 0.144 | 0.297 | 0.339 | 0.203 | 0.376 | 0.503 |

| support>0.5 | p152  | loss  |       |       |       |       |       |       |       |       |       |       |
| ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1         | 0.103 | 0.210 | 0.095 | 0.085 | 0.122 | 0.165 | 0.114 | 0.253 | 0.281 | 0.168 | 0.318 | 0.422 |
| 1_2         | 0.106 | 0.210 | 0.096 | 0.071 | 0.124 | 0.166 | 0.116 | 0.261 | 0.297 | 0.158 | 0.343 | 0.443 |
| 1_3         | 0.107 | 0.209 | 0.103 | 0.057 | 0.123 | 0.163 | 0.125 | 0.262 | 0.299 | 0.162 | 0.328 | 0.444 |
| 1_4         | 0.116 | 0.219 | 0.114 | 0.071 | 0.135 | 0.178 | 0.127 | 0.276 | 0.308 | 0.174 | 0.343 | 0.468 |
| 1_5         | 0.129 | 0.236 | 0.129 | 0.062 | 0.150 | 0.208 | 0.139 | 0.285 | 0.322 | 0.186 | 0.366 | 0.479 |
| 1_6         | 0.126 | 0.236 | 0.124 | 0.066 | 0.137 | 0.208 | 0.142 | 0.287 | 0.322 | 0.198 | 0.353 | 0.484 |
| 1_7         | 0.127 | 0.233 | 0.127 | 0.068 | 0.140 | 0.209 | 0.138 | 0.284 | 0.329 | 0.195 | 0.371 | 0.488 |
| 1_8         | 0.131 | 0.240 | 0.132 | 0.065 | 0.149 | 0.217 | 0.144 | 0.290 | 0.328 | 0.208 | 0.367 | 0.493 |
| 1_9         | 0.132 | 0.240 | 0.133 | 0.068 | 0.146 | 0.213 | 0.139 | 0.290 | 0.328 | 0.202 | 0.364 | 0.490 |
| 1_10        | 0.132 | 0.240 | 0.132 | 0.067 | 0.142 | 0.219 | 0.142 | 0.292 | 0.331 | 0.201 | 0.370 | 0.492 |

| crop>0.7 | p128  | loss  |       |       |       |       |       |       |       |       |       |       |
| -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1      | 0.098 | 0.212 | 0.087 | 0.064 | 0.114 | 0.165 | 0.113 | 0.244 | 0.271 | 0.145 | 0.295 | 0.428 |
| 1_2      | 0.109 | 0.220 | 0.101 | 0.056 | 0.125 | 0.167 | 0.128 | 0.259 | 0.299 | 0.179 | 0.343 | 0.441 |
| 1_3      | 0.118 | 0.227 | 0.110 | 0.068 | 0.136 | 0.185 | 0.131 | 0.279 | 0.309 | 0.180 | 0.352 | 0.471 |
| 1_4      | 0.111 | 0.217 | 0.105 | 0.063 | 0.131 | 0.166 | 0.126 | 0.267 | 0.305 | 0.178 | 0.351 | 0.456 |
| 1_5      | 0.130 | 0.244 | 0.125 | 0.068 | 0.145 | 0.207 | 0.139 | 0.292 | 0.328 | 0.190 | 0.366 | 0.489 |
| 1_6      | 0.134 | 0.247 | 0.131 | 0.074 | 0.153 | 0.209 | 0.142 | 0.296 | 0.333 | 0.196 | 0.374 | 0.492 |
| 1_7      | 0.131 | 0.237 | 0.130 | 0.062 | 0.147 | 0.212 | 0.144 | 0.290 | 0.326 | 0.211 | 0.356 | 0.491 |
| 1_8      | 0.132 | 0.243 | 0.129 | 0.060 | 0.147 | 0.217 | 0.142 | 0.290 | 0.332 | 0.226 | 0.373 | 0.486 |
| 1_9      | 0.133 | 0.243 | 0.130 | 0.057 | 0.141 | 0.220 | 0.144 | 0.291 | 0.331 | 0.207 | 0.371 | 0.491 |
| 1_10     | 0.130 | 0.238 | 0.128 | 0.063 | 0.143 | 0.210 | 0.140 | 0.294 | 0.335 | 0.222 | 0.372 | 0.496 |

| support>0.7 | p128  | loss  |       |       |       |       |       |       |       |       |       |       |
| ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1         | 0.089 | 0.183 | 0.078 | 0.045 | 0.105 | 0.129 | 0.108 | 0.242 | 0.275 | 0.149 | 0.306 | 0.422 |
| 1_2         | 0.110 | 0.215 | 0.101 | 0.070 | 0.125 | 0.168 | 0.123 | 0.259 | 0.296 | 0.174 | 0.336 | 0.440 |
| 1_3         | 0.111 | 0.216 | 0.106 | 0.042 | 0.122 | 0.182 | 0.131 | 0.276 | 0.311 | 0.159 | 0.343 | 0.477 |
| 1_4         | 0.114 | 0.222 | 0.113 | 0.053 | 0.134 | 0.170 | 0.124 | 0.277 | 0.308 | 0.177 | 0.342 | 0.462 |
| 1_5         | 0.131 | 0.242 | 0.131 | 0.080 | 0.143 | 0.209 | 0.143 | 0.297 | 0.330 | 0.188 | 0.365 | 0.494 |
| 1_6         | 0.132 | 0.239 | 0.126 | 0.086 | 0.143 | 0.211 | 0.142 | 0.293 | 0.328 | 0.200 | 0.363 | 0.481 |
| 1_7         | 0.132 | 0.242 | 0.131 | 0.084 | 0.141 | 0.214 | 0.142 | 0.294 | 0.330 | 0.193 | 0.359 | 0.498 |
| 1_8         | 0.127 | 0.232 | 0.122 | 0.066 | 0.141 | 0.205 | 0.138 | 0.283 | 0.323 | 0.195 | 0.360 | 0.482 |
| 1_9         | 0.132 | 0.245 | 0.126 | 0.086 | 0.146 | 0.210 | 0.140 | 0.290 | 0.325 | 0.198 | 0.367 | 0.480 |
| 1_10        | 0.133 | 0.244 | 0.128 | 0.081 | 0.146 | 0.218 | 0.142 | 0.291 | 0.329 | 0.194 | 0.368 | 0.486 |

| support>0.6 | p128  | loss  |       |       |       |       |       |       |       |       |       |       |
| ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1         | 0.094 | 0.200 | 0.086 | 0.054 | 0.110 | 0.153 | 0.111 | 0.243 | 0.272 | 0.140 | 0.301 | 0.415 |
| 1_2         | 0.104 | 0.206 | 0.093 | 0.052 | 0.119 | 0.170 | 0.123 | 0.250 | 0.281 | 0.163 | 0.310 | 0.425 |
| 1_3         | 0.111 | 0.223 | 0.102 | 0.056 | 0.141 | 0.168 | 0.122 | 0.267 | 0.302 | 0.187 | 0.353 | 0.431 |
| 1_4         | 0.120 | 0.231 | 0.112 | 0.080 | 0.132 | 0.182 | 0.132 | 0.276 | 0.309 | 0.188 | 0.350 | 0.452 |
| 1_5         | 0.124 | 0.235 | 0.115 | 0.081 | 0.133 | 0.194 | 0.136 | 0.288 | 0.327 | 0.199 | 0.362 | 0.473 |
| 1_6         | 0.128 | 0.237 | 0.123 | 0.082 | 0.136 | 0.214 | 0.141 | 0.287 | 0.330 | 0.213 | 0.360 | 0.483 |
| 1_7         | 0.130 | 0.238 | 0.131 | 0.089 | 0.135 | 0.214 | 0.143 | 0.293 | 0.331 | 0.204 | 0.364 | 0.483 |
| 1_8         | 0.129 | 0.240 | 0.127 | 0.088 | 0.143 | 0.208 | 0.140 | 0.290 | 0.329 | 0.199 | 0.372 | 0.483 |
| 1_9         | 0.134 | 0.242 | 0.130 | 0.080 | 0.145 | 0.209 | 0.141 | 0.293 | 0.332 | 0.202 | 0.373 | 0.494 |
| 1_10        | 0.132 | 0.243 | 0.126 | 0.085 | 0.141 | 0.211 | 0.142 | 0.292 | 0.334 | 0.201 | 0.368 | 0.489 |

| support>0.5 | p1024 | loss  |       |       |       |       |       |       |       |       |       |       |
| ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1         | 0.103 | 0.205 | 0.096 | 0.051 | 0.115 | 0.170 | 0.118 | 0.249 | 0.277 | 0.131 | 0.310 | 0.421 |
| 1_2         | 0.104 | 0.200 | 0.095 | 0.050 | 0.120 | 0.174 | 0.123 | 0.252 | 0.287 | 0.169 | 0.323 | 0.424 |
| 1_3         | 0.112 | 0.223 | 0.101 | 0.075 | 0.133 | 0.174 | 0.129 | 0.275 | 0.303 | 0.166 | 0.341 | 0.467 |
| 1_4         | 0.115 | 0.220 | 0.108 | 0.063 | 0.141 | 0.170 | 0.132 | 0.275 | 0.313 | 0.198 | 0.351 | 0.449 |
| 1_5         | 0.126 | 0.238 | 0.123 | 0.069 | 0.139 | 0.204 | 0.141 | 0.283 | 0.322 | 0.200 | 0.356 | 0.490 |
| 1_6         | 0.131 | 0.238 | 0.132 | 0.071 | 0.149 | 0.212 | 0.138 | 0.290 | 0.326 | 0.203 | 0.371 | 0.484 |
| 1_7         | 0.132 | 0.241 | 0.130 | 0.061 | 0.147 | 0.215 | 0.142 | 0.290 | 0.327 | 0.202 | 0.368 | 0.493 |
| 1_8         | 0.132 | 0.240 | 0.131 | 0.078 | 0.148 | 0.217 | 0.141 | 0.293 | 0.328 | 0.203 | 0.365 | 0.490 |
| 1_9         | 0.129 | 0.238 | 0.125 | 0.061 | 0.143 | 0.212 | 0.141 | 0.291 | 0.329 | 0.218 | 0.366 | 0.488 |
| 1_10        | 0.131 | 0.236 | 0.127 | 0.067 | 0.145 | 0.215 | 0.140 | 0.293 | 0.331 | 0.206 | 0.365 | 0.498 |

| support>0.5 | p128  | margin+0.7bt | 8     |       |       |       |       |       |       |       |       |       |
| ----------- | ----- | ------------ | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1         | 0.097 | 0.204        | 0.086 | 0.057 | 0.119 | 0.156 | 0.115 | 0.249 | 0.277 | 0.166 | 0.289 | 0.434 |
| 1_2         | 0.105 | 0.207        | 0.096 | 0.050 | 0.109 | 0.168 | 0.118 | 0.265 | 0.302 | 0.156 | 0.334 | 0.470 |
| 1_3         | 0.115 | 0.215        | 0.114 | 0.050 | 0.124 | 0.196 | 0.131 | 0.279 | 0.315 | 0.196 | 0.336 | 0.482 |
| 1_4         | 0.089 | 0.177        | 0.086 | 0.055 | 0.094 | 0.157 | 0.104 | 0.254 | 0.296 | 0.166 | 0.335 | 0.457 |
| 1_5         | 0.129 | 0.231        | 0.128 | 0.056 | 0.138 | 0.205 | 0.138 | 0.290 | 0.333 | 0.185 | 0.369 | 0.487 |
| 1_6         | 0.129 | 0.231        | 0.128 | 0.068 | 0.134 | 0.210 | 0.136 | 0.288 | 0.332 | 0.216 | 0.368 | 0.484 |
| 1_7         | 0.133 | 0.239        | 0.131 | 0.073 | 0.146 | 0.215 | 0.144 | 0.293 | 0.333 | 0.196 | 0.371 | 0.510 |
| 1_8         | 0.130 | 0.231        | 0.128 | 0.088 | 0.131 | 0.206 | 0.138 | 0.296 | 0.336 | 0.204 | 0.379 | 0.496 |
| 1_9         | 0.131 | 0.232        | 0.133 | 0.059 | 0.141 | 0.208 | 0.139 | 0.296 | 0.336 | 0.184 | 0.376 | 0.504 |
| 1_10        | 0.133 | 0.234        | 0.133 | 0.056 | 0.142 | 0.219 | 0.143 | 0.297 | 0.339 | 0.189 | 0.380 | 0.505 |

| support>0.5 | p128  | 2margin+0.3bt | 8     |       |       |       |       |       |       |       |       |       |
| ----------- | ----- | ------------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1         | 0.083 | 0.172         | 0.073 | 0.039 | 0.093 | 0.140 | 0.102 | 0.224 | 0.267 | 0.156 | 0.302 | 0.401 |
| 1_2         | 0.103 | 0.206         | 0.096 | 0.063 | 0.123 | 0.157 | 0.121 | 0.261 | 0.292 | 0.177 | 0.330 | 0.420 |
| 1_3         | 0.102 | 0.200         | 0.094 | 0.063 | 0.112 | 0.163 | 0.119 | 0.258 | 0.303 | 0.202 | 0.337 | 0.451 |
| 1_4         | 0.119 | 0.219         | 0.119 | 0.055 | 0.133 | 0.191 | 0.129 | 0.272 | 0.306 | 0.153 | 0.334 | 0.472 |
| 1_5         | 0.131 | 0.240         | 0.129 | 0.062 | 0.143 | 0.214 | 0.140 | 0.291 | 0.329 | 0.190 | 0.362 | 0.498 |
| 1_6         | 0.130 | 0.239         | 0.124 | 0.063 | 0.138 | 0.211 | 0.141 | 0.292 | 0.333 | 0.205 | 0.369 | 0.501 |
| 1_7         | 0.127 | 0.231         | 0.123 | 0.069 | 0.134 | 0.197 | 0.138 | 0.291 | 0.329 | 0.198 | 0.366 | 0.486 |
| 1_8         | 0.134 | 0.241         | 0.134 | 0.063 | 0.146 | 0.214 | 0.144 | 0.295 | 0.337 | 0.197 | 0.382 | 0.497 |
| 1_9         | 0.135 | 0.241         | 0.136 | 0.065 | 0.144 | 0.217 | 0.148 | 0.297 | 0.336 | 0.186 | 0.368 | 0.503 |
| 1_10        | 0.130 | 0.234         | 0.128 | 0.070 | 0.138 | 0.216 | 0.145 | 0.291 | 0.334 | 0.195 | 0.375 | 0.497 |

| support>0.5 | p128  | new_loss | 16    |       |       |       |       |       |       |       |       |       |
| ----------- | ----- | -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1         | 0.094 | 0.191    | 0.086 | 0.053 | 0.117 | 0.147 | 0.109 | 0.236 | 0.275 | 0.179 | 0.317 | 0.395 |
| 1_2         | 0.100 | 0.200    | 0.089 | 0.049 | 0.110 | 0.152 | 0.111 | 0.248 | 0.285 | 0.176 | 0.323 | 0.420 |
| 1_3         | 0.111 | 0.229    | 0.101 | 0.057 | 0.130 | 0.187 | 0.122 | 0.258 | 0.290 | 0.166 | 0.324 | 0.446 |
| 1_4         | 0.105 | 0.213    | 0.097 | 0.072 | 0.118 | 0.173 | 0.120 | 0.262 | 0.305 | 0.191 | 0.338 | 0.453 |
| 1_5         | 0.127 | 0.235    | 0.125 | 0.078 | 0.142 | 0.212 | 0.138 | 0.286 | 0.323 | 0.183 | 0.371 | 0.475 |
| 1_6         | 0.126 | 0.238    | 0.123 | 0.059 | 0.137 | 0.207 | 0.139 | 0.283 | 0.320 | 0.197 | 0.359 | 0.480 |
| 1_7         | 0.132 | 0.244    | 0.128 | 0.072 | 0.143 | 0.217 | 0.139 | 0.290 | 0.326 | 0.193 | 0.357 | 0.488 |
| 1_8         | 0.132 | 0.239    | 0.131 | 0.090 | 0.148 | 0.220 | 0.140 | 0.290 | 0.325 | 0.195 | 0.360 | 0.490 |
| 1_9         | 0.130 | 0.240    | 0.126 | 0.067 | 0.143 | 0.215 | 0.138 | 0.290 | 0.325 | 0.201 | 0.364 | 0.475 |
| 1_10        | 0.132 | 0.239    | 0.133 | 0.071 | 0.141 | 0.223 | 0.136 | 0.288 | 0.326 | 0.197 | 0.361 | 0.483 |

|      |       | new_loss | 16    |       |       |       |       |       |       |       |       |       |
| ---- | ----- | -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1  | 0.099 | 0.208    | 0.089 | 0.042 | 0.120 | 0.152 | 0.118 | 0.243 | 0.272 | 0.137 | 0.305 | 0.419 |
| 1_2  | 0.109 | 0.216    | 0.103 | 0.056 | 0.128 | 0.170 | 0.124 | 0.257 | 0.288 | 0.177 | 0.316 | 0.454 |
| 1_3  | 0.106 | 0.210    | 0.094 | 0.060 | 0.117 | 0.170 | 0.120 | 0.243 | 0.279 | 0.179 | 0.300 | 0.416 |
| 1_4  | 0.111 | 0.218    | 0.104 | 0.057 | 0.120 | 0.182 | 0.127 | 0.266 | 0.300 | 0.161 | 0.319 | 0.450 |
| 1_5  | 0.130 | 0.237    | 0.128 | 0.058 | 0.143 | 0.221 | 0.137 | 0.285 | 0.324 | 0.167 | 0.362 | 0.484 |
| 1_6  | 0.133 | 0.243    | 0.131 | 0.060 | 0.142 | 0.225 | 0.141 | 0.291 | 0.325 | 0.166 | 0.355 | 0.496 |
| 1_7  | 0.127 | 0.230    | 0.125 | 0.058 | 0.135 | 0.219 | 0.136 | 0.286 | 0.328 | 0.177 | 0.365 | 0.491 |
| 1_8  | 0.129 | 0.234    | 0.127 | 0.057 | 0.147 | 0.214 | 0.135 | 0.287 | 0.326 | 0.179 | 0.374 | 0.479 |
| 1_9  | 0.126 | 0.228    | 0.119 | 0.059 | 0.140 | 0.201 | 0.136 | 0.285 | 0.329 | 0.173 | 0.370 | 0.481 |
| 1_10 | 0.128 | 0.233    | 0.124 | 0.057 | 0.136 | 0.212 | 0.135 | 0.288 | 0.327 | 0.166 | 0.367 | 0.489 |

| support>0.5 | new_loss |       |       |       |       |       |       |       |       |       |       |       |
| ----------- | -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1         | 0.096    | 0.204 | 0.084 | 0.062 | 0.112 | 0.155 | 0.113 | 0.251 | 0.279 | 0.161 | 0.312 | 0.432 |
| 1_2         | 0.102    | 0.204 | 0.092 | 0.058 | 0.111 | 0.161 | 0.119 | 0.255 | 0.284 | 0.134 | 0.327 | 0.426 |
| 1_3         | 0.112    | 0.214 | 0.107 | 0.053 | 0.121 | 0.180 | 0.125 | 0.256 | 0.297 | 0.149 | 0.344 | 0.439 |
| 1_4         | 0.103    | 0.201 | 0.095 | 0.053 | 0.106 | 0.156 | 0.123 | 0.265 | 0.298 | 0.134 | 0.332 | 0.452 |
| 1_5         | 0.127    | 0.235 | 0.126 | 0.051 | 0.139 | 0.204 | 0.138 | 0.283 | 0.322 | 0.183 | 0.368 | 0.478 |
| 1_6         | 0.127    | 0.234 | 0.124 | 0.058 | 0.140 | 0.210 | 0.137 | 0.283 | 0.322 | 0.188 | 0.361 | 0.481 |
| 1_7         | 0.134    | 0.246 | 0.132 | 0.061 | 0.148 | 0.219 | 0.140 | 0.291 | 0.328 | 0.200 | 0.371 | 0.492 |
| 1_8         | 0.130    | 0.234 | 0.127 | 0.052 | 0.143 | 0.210 | 0.137 | 0.287 | 0.324 | 0.182 | 0.365 | 0.486 |
| 1_9         | 0.130    | 0.237 | 0.127 | 0.057 | 0.140 | 0.214 | 0.136 | 0.286 | 0.323 | 0.184 | 0.365 | 0.486 |
| 1_10        | 0.131    | 0.238 | 0.128 | 0.060 | 0.143 | 0.216 | 0.140 | 0.286 | 0.324 | 0.185 | 0.366 | 0.485 |

| support>0.7 | p128  | new_loss | 64    |       |       |       |       |       |       |       |       |       |
| ----------- | ----- | -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1         | 0.086 | 0.195    | 0.069 | 0.039 | 0.110 | 0.141 | 0.105 | 0.217 | 0.242 | 0.127 | 0.268 | 0.388 |
| 1_2         | 0.108 | 0.221    | 0.097 | 0.055 | 0.123 | 0.170 | 0.121 | 0.248 | 0.279 | 0.161 | 0.306 | 0.414 |
| 1_3         | 0.119 | 0.234    | 0.114 | 0.062 | 0.137 | 0.190 | 0.133 | 0.259 | 0.288 | 0.166 | 0.325 | 0.438 |
| 1_4         | 0.114 | 0.225    | 0.112 | 0.068 | 0.131 | 0.176 | 0.126 | 0.258 | 0.288 | 0.168 | 0.324 | 0.440 |
| 1_5         | 0.128 | 0.244    | 0.125 | 0.094 | 0.146 | 0.203 | 0.138 | 0.273 | 0.301 | 0.180 | 0.340 | 0.455 |
| 1_6         | 0.124 | 0.239    | 0.121 | 0.097 | 0.142 | 0.195 | 0.130 | 0.272 | 0.303 | 0.189 | 0.337 | 0.450 |
| 1_7         | 0.127 | 0.245    | 0.120 | 0.071 | 0.143 | 0.204 | 0.135 | 0.268 | 0.303 | 0.180 | 0.338 | 0.450 |
| 1_8         | 0.126 | 0.239    | 0.124 | 0.081 | 0.149 | 0.204 | 0.135 | 0.275 | 0.303 | 0.169 | 0.338 | 0.464 |
| 1_9         | 0.125 | 0.238    | 0.120 | 0.092 | 0.143 | 0.203 | 0.132 | 0.275 | 0.304 | 0.182 | 0.335 | 0.465 |
| 1_10        | 0.127 | 0.241    | 0.126 | 0.086 | 0.142 | 0.210 | 0.135 | 0.277 | 0.307 | 0.174 | 0.337 | 0.466 |











### 添加 similarity

|                         | Epoch 10 | Max   |
| ----------------------- | -------- | ----- |
| 原代码                  | 0.232    | 0.238 |
| 以概率0.5目标互换       | 0.241    | 0.246 |
| crop&probability>0.5    |          |       |
| crop&probability<0.5    | 0.109    | 0.133 |
| support&probability>0.5 |          |       |
| support&probability<0.5 | 0.127    | 0.139 |
|                         |          |       |
|                         |          |       |
|                         |          |       |

| crop | probability | > 0.7 |       |       |       |       |       |       |       |       |       |       |
| ---- | ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1  | 0.087       | 0.183 | 0.077 | 0.045 | 0.106 | 0.131 | 0.103 | 0.232 | 0.268 | 0.146 | 0.299 | 0.411 |
| 1_2  | 0.097       | 0.197 | 0.085 | 0.055 | 0.120 | 0.155 | 0.116 | 0.253 | 0.294 | 0.175 | 0.334 | 0.447 |
| 1_3  | 0.096       | 0.194 | 0.087 | 0.049 | 0.107 | 0.147 | 0.113 | 0.246 | 0.283 | 0.141 | 0.305 | 0.430 |
| 1_4  | 0.115       | 0.217 | 0.112 | 0.066 | 0.134 | 0.166 | 0.128 | 0.275 | 0.310 | 0.179 | 0.346 | 0.464 |
| 1_5  | 0.127       | 0.235 | 0.121 | 0.059 | 0.138 | 0.204 | 0.136 | 0.285 | 0.329 | 0.169 | 0.365 | 0.484 |
| 1_6  | 0.128       | 0.235 | 0.118 | 0.055 | 0.142 | 0.204 | 0.140 | 0.295 | 0.335 | 0.167 | 0.376 | 0.503 |
| 1_7  | 0.128       | 0.238 | 0.120 | 0.059 | 0.141 | 0.208 | 0.139 | 0.291 | 0.328 | 0.169 | 0.362 | 0.490 |
| 1_8  | 0.124       | 0.231 | 0.116 | 0.059 | 0.126 | 0.207 | 0.137 | 0.292 | 0.334 | 0.205 | 0.364 | 0.502 |
| 1_9  | 0.129       | 0.236 | 0.126 | 0.064 | 0.136 | 0.213 | 0.140 | 0.299 | 0.339 | 0.196 | 0.380 | 0.505 |
| 1_10 | 0.133       | 0.239 | 0.132 | 0.062 | 0.138 | 0.215 | 0.142 | 0.297 | 0.339 | 0.210 | 0.372 | 0.499 |

| crop | probability | > 0.6 |       |       |       |       |       |       |       |       |       |       |
| ---- | ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1  | 0.085       | 0.182 | 0.068 | 0.047 | 0.093 | 0.123 | 0.106 | 0.226 | 0.262 | 0.135 | 0.289 | 0.387 |
| 1_2  | 0.092       | 0.190 | 0.078 | 0.059 | 0.101 | 0.143 | 0.105 | 0.250 | 0.291 | 0.176 | 0.331 | 0.438 |
| 1_3  | 0.101       | 0.207 | 0.094 | 0.053 | 0.120 | 0.162 | 0.115 | 0.258 | 0.301 | 0.171 | 0.339 | 0.458 |
| 1_4  | 0.113       | 0.211 | 0.107 | 0.050 | 0.117 | 0.189 | 0.124 | 0.266 | 0.302 | 0.148 | 0.328 | 0.458 |
| 1_5  | 0.123       | 0.232 | 0.123 | 0.052 | 0.130 | 0.198 | 0.130 | 0.285 | 0.325 | 0.181 | 0.361 | 0.479 |
| 1_6  | 0.122       | 0.229 | 0.116 | 0.055 | 0.128 | 0.208 | 0.139 | 0.294 | 0.334 | 0.200 | 0.369 | 0.509 |
| 1_7  | 0.121       | 0.230 | 0.115 | 0.056 | 0.123 | 0.200 | 0.135 | 0.285 | 0.329 | 0.195 | 0.363 | 0.490 |
| 1_8  | 0.121       | 0.221 | 0.115 | 0.054 | 0.124 | 0.200 | 0.139 | 0.290 | 0.334 | 0.210 | 0.368 | 0.483 |
| 1_9  | 0.121       | 0.225 | 0.121 | 0.058 | 0.127 | 0.192 | 0.138 | 0.284 | 0.327 | 0.181 | 0.366 | 0.487 |
| 1_10 | 0.121       | 0.228 | 0.113 | 0.059 | 0.121 | 0.209 | 0.137 | 0.284 | 0.333 | 0.191 | 0.370 | 0.494 |

| crop | probability | > 0.5 |       |       |       |       |       |       |       |       |       |       |
| ---- | ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1  | 0.092       | 0.190 | 0.082 | 0.045 | 0.101 | 0.156 | 0.115 | 0.237 | 0.269 | 0.125 | 0.305 | 0.416 |
| 1_2  | 0.109       | 0.216 | 0.102 | 0.083 | 0.130 | 0.165 | 0.119 | 0.259 | 0.294 | 0.186 | 0.336 | 0.453 |
| 1_3  | 0.104       | 0.205 | 0.099 | 0.057 | 0.119 | 0.159 | 0.120 | 0.253 | 0.289 | 0.141 | 0.316 | 0.473 |
| 1_4  | 0.098       | 0.204 | 0.088 | 0.044 | 0.113 | 0.155 | 0.117 | 0.259 | 0.299 | 0.185 | 0.338 | 0.449 |
| 1_5  | 0.120       | 0.223 | 0.116 | 0.056 | 0.130 | 0.189 | 0.133 | 0.284 | 0.324 | 0.203 | 0.363 | 0.475 |
| 1_6  | 0.119       | 0.222 | 0.115 | 0.058 | 0.127 | 0.188 | 0.135 | 0.286 | 0.327 | 0.194 | 0.370 | 0.479 |
| 1_7  | 0.127       | 0.235 | 0.124 | 0.056 | 0.134 | 0.194 | 0.141 | 0.292 | 0.327 | 0.205 | 0.358 | 0.478 |
| 1_8  | 0.131       | 0.237 | 0.130 | 0.056 | 0.135 | 0.210 | 0.143 | 0.294 | 0.332 | 0.199 | 0.368 | 0.494 |
| 1_9  | 0.118       | 0.214 | 0.116 | 0.055 | 0.118 | 0.195 | 0.133 | 0.282 | 0.326 | 0.209 | 0.363 | 0.482 |
| 1_10 | 0.130       | 0.233 | 0.129 | 0.058 | 0.132 | 0.216 | 0.143 | 0.293 | 0.338 | 0.214 | 0.371 | 0.503 |

| crop | probability | < 0.5     |       |       |       |       |       |       |       |       |       |       |
| ---- | ----------- | --------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1  | 0.057       | **0.133** | 0.045 | 0.022 | 0.082 | 0.096 | 0.077 | 0.194 | 0.242 | 0.157 | 0.282 | 0.343 |
| 1_2  | 0.046       | 0.107     | 0.035 | 0.031 | 0.063 | 0.081 | 0.067 | 0.172 | 0.236 | 0.157 | 0.260 | 0.358 |
| 1_3  | 0.048       | 0.105     | 0.041 | 0.026 | 0.054 | 0.081 | 0.076 | 0.173 | 0.235 | 0.127 | 0.251 | 0.356 |
| 1_4  | 0.033       | 0.069     | 0.029 | 0.021 | 0.064 | 0.098 | 0.057 | 0.143 | 0.219 | 0.094 | 0.227 | 0.364 |
| 1_5  | 0.056       | 0.107     | 0.050 | 0.031 | 0.092 | 0.127 | 0.080 | 0.179 | 0.274 | 0.151 | 0.299 | 0.408 |
| 1_6  | 0.058       | 0.113     | 0.052 | 0.033 | 0.101 | 0.121 | 0.078 | 0.183 | 0.274 | 0.161 | 0.307 | 0.397 |
| 1_7  | 0.056       | 0.108     | 0.051 | 0.029 | 0.087 | 0.115 | 0.075 | 0.175 | 0.266 | 0.145 | 0.293 | 0.391 |
| 1_8  | 0.050       | 0.102     | 0.045 | 0.031 | 0.086 | 0.110 | 0.079 | 0.186 | 0.268 | 0.142 | 0.294 | 0.398 |
| 1_9  | 0.066       | 0.123     | 0.062 | 0.033 | 0.096 | 0.125 | 0.082 | 0.192 | 0.267 | 0.156 | 0.288 | 0.404 |
| 1_10 | 0.057       | 0.109     | 0.053 | 0.030 | 0.088 | 0.121 | 0.080 | 0.186 | 0.278 | 0.157 | 0.308 | 0.406 |

| support | probability | > 0.7 |       |       |       |       |       |       |       |       |       |       |
| ------- | ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1     | 0.092       | 0.199 | 0.078 | 0.078 | 0.106 | 0.151 | 0.106 | 0.236 | 0.266 | 0.155 | 0.285 | 0.427 |
| 1_2     | 0.107       | 0.214 | 0.096 | 0.058 | 0.134 | 0.159 | 0.119 | 0.258 | 0.294 | 0.142 | 0.340 | 0.447 |
| 1_3     | 0.093       | 0.189 | 0.084 | 0.051 | 0.109 | 0.135 | 0.106 | 0.248 | 0.280 | 0.153 | 0.304 | 0.437 |
| 1_4     | 0.106       | 0.202 | 0.099 | 0.048 | 0.115 | 0.158 | 0.125 | 0.258 | 0.299 | 0.184 | 0.327 | 0.450 |
| 1_5     | 0.122       | 0.224 | 0.119 | 0.053 | 0.135 | 0.199 | 0.132 | 0.287 | 0.328 | 0.174 | 0.376 | 0.487 |
| 1_6     | 0.127       | 0.232 | 0.122 | 0.057 | 0.137 | 0.202 | 0.133 | 0.289 | 0.329 | 0.167 | 0.366 | 0.493 |
| 1_7     | 0.129       | 0.233 | 0.127 | 0.065 | 0.141 | 0.214 | 0.135 | 0.294 | 0.336 | 0.217 | 0.373 | 0.502 |
| 1_8     | 0.124       | 0.224 | 0.120 | 0.058 | 0.138 | 0.207 | 0.132 | 0.287 | 0.334 | 0.184 | 0.375 | 0.492 |
| 1_9     | 0.128       | 0.230 | 0.122 | 0.066 | 0.136 | 0.203 | 0.139 | 0.294 | 0.338 | 0.176 | 0.379 | 0.502 |
| 1_10    | 0.132       | 0.236 | 0.132 | 0.063 | 0.147 | 0.216 | 0.138 | 0.296 | 0.337 | 0.213 | 0.377 | 0.494 |

| support | probability | > 0.6 |       |       |       |       |       |       |       |       |       |       |
| ------- | ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1     | 0.092       | 0.190 | 0.084 | 0.039 | 0.107 | 0.151 | 0.116 | 0.231 | 0.271 | 0.155 | 0.313 | 0.406 |
| 1_2     | 0.099       | 0.195 | 0.091 | 0.044 | 0.105 | 0.184 | 0.114 | 0.244 | 0.284 | 0.139 | 0.329 | 0.442 |
| 1_3     | 0.104       | 0.208 | 0.095 | 0.064 | 0.108 | 0.159 | 0.117 | 0.260 | 0.299 | 0.175 | 0.328 | 0.428 |
| 1_4     | 0.113       | 0.217 | 0.107 | 0.058 | 0.123 | 0.173 | 0.122 | 0.275 | 0.310 | 0.191 | 0.349 | 0.455 |
| 1_5     | 0.126       | 0.230 | 0.119 | 0.058 | 0.146 | 0.198 | 0.133 | 0.287 | 0.328 | 0.174 | 0.371 | 0.481 |
| 1_6     | 0.134       | 0.243 | 0.133 | 0.060 | 0.145 | 0.219 | 0.140 | 0.291 | 0.332 | 0.190 | 0.372 | 0.502 |
|         |             |       |       |       |       |       |       |       |       |       |       |       |
|         |             |       |       |       |       |       |       |       |       |       |       |       |
|         |             |       |       |       |       |       |       |       |       |       |       |       |
|         |             |       |       |       |       |       |       |       |       |       |       |       |

| support | probability | > 0.5     |       |       |       |       |       |       |       |       |       |       |
| ------- | ----------- | --------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1     | 0.096       | 0.202     | 0.086 | 0.045 | 0.116 | 0.144 | 0.112 | 0.243 | 0.276 | 0.156 | 0.310 | 0.416 |
| 1_2     | 0.093       | 0.191     | 0.086 | 0.051 | 0.100 | 0.144 | 0.111 | 0.248 | 0.282 | 0.155 | 0.310 | 0.429 |
| 1_3     | 0.101       | 0.201     | 0.094 | 0.044 | 0.126 | 0.162 | 0.117 | 0.262 | 0.290 | 0.137 | 0.323 | 0.460 |
| 1_4     | 0.110       | 0.215     | 0.105 | 0.052 | 0.123 | 0.169 | 0.127 | 0.269 | 0.309 | 0.156 | 0.351 | 0.461 |
| 1_5     | 0.131       | 0.240     | 0.128 | 0.064 | 0.144 | 0.212 | 0.138 | 0.292 | 0.333 | 0.220 | 0.374 | 0.488 |
| 1_6     | 0.132       | 0.236     | 0.131 | 0.060 | 0.143 | 0.214 | 0.140 | 0.293 | 0.334 | 0.205 | 0.380 | 0.492 |
| 1_7     | 0.131       | 0.236     | 0.131 | 0.061 | 0.135 | 0.215 | 0.141 | 0.293 | 0.333 | 0.217 | 0.367 | 0.489 |
| 1_8     | 0.130       | 0.237     | 0.125 | 0.089 | 0.141 | 0.212 | 0.145 | 0.300 | 0.341 | 0.204 | 0.379 | 0.502 |
| 1_9     | 0.132       | 0.237     | 0.131 | 0.058 | 0.141 | 0.209 | 0.141 | 0.293 | 0.332 | 0.207 | 0.366 | 0.498 |
| 1_10    | 0.134       | **0.241** | 0.128 | 0.054 | 0.144 | 0.220 | 0.144 | 0.294 | 0.334 | 0.203 | 0.372 | 0.504 |

| support | probability | < 0.5     |       |       |       |       |       |       |       |       |       |       |
| ------- | ----------- | --------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1     | 0.047       | 0.106     | 0.038 | 0.024 | 0.058 | 0.088 | 0.061 | 0.159 | 0.218 | 0.116 | 0.235 | 0.335 |
| 1_2     | 0.048       | 0.102     | 0.041 | 0.024 | 0.076 | 0.093 | 0.072 | 0.174 | 0.242 | 0.125 | 0.260 | 0.371 |
| 1_3     | 0.052       | 0.111     | 0.042 | 0.028 | 0.070 | 0.103 | 0.069 | 0.172 | 0.238 | 0.171 | 0.251 | 0.357 |
| 1_4     | 0.040       | 0.079     | 0.035 | 0.025 | 0.070 | 0.093 | 0.055 | 0.159 | 0.240 | 0.143 | 0.253 | 0.357 |
| 1_5     | 0.069       | **0.139** | 0.064 | 0.035 | 0.095 | 0.127 | 0.084 | 0.194 | 0.271 | 0.148 | 0.298 | 0.406 |
| 1_6     | 0.062       | 0.122     | 0.057 | 0.034 | 0.088 | 0.131 | 0.080 | 0.189 | 0.272 | 0.142 | 0.292 | 0.415 |
| 1_7     | 0.057       | 0.110     | 0.053 | 0.030 | 0.087 | 0.124 | 0.073 | 0.173 | 0.268 | 0.147 | 0.289 | 0.404 |
| 1_8     | 0.064       | 0.128     | 0.055 | 0.035 | 0.092 | 0.118 | 0.082 | 0.193 | 0.273 | 0.150 | 0.300 | 0.407 |
| 1_9     | 0.058       | 0.114     | 0.054 | 0.036 | 0.089 | 0.122 | 0.075 | 0.179 | 0.265 | 0.146 | 0.295 | 0.396 |
| 1_10    | 0.067       | 0.127     | 0.062 | 0.037 | 0.094 | 0.133 | 0.083 | 0.192 | 0.282 | 0.162 | 0.308 | 0.423 |

```python
# One-Shot-Object-Detection-switch/trainval_switch.py
from roi_data_layer.roibatchLoader_similarity_support import roibatchLoader

# One-Shot-Object-Detection-switch/lib/roi_data_layer/roibatchLoader_similarity_support.py
def vgg_match(image1, image2):
    '''VGG16特征匹配'''
    try:
        from tensorflow import keras
        from numpy import linalg as LA
        from keras.preprocessing import image
        from keras.applications.vgg16 import VGG16
        from keras.applications.vgg16 import preprocess_input
    except:
        return -1

    input_shape = (64, 64, 3)
    model = VGG16(weights='imagenet', pooling='max', include_top=False, input_shape=input_shape)

    def extract_feat(img):
        '''提取图像特征'''
        # img = image.load_img(img_path, target_size=(input_shape[0], input_shape[1]))
        img = img.resize((input_shape[0], input_shape[1]),Image.ANTIALIAS)
        img = image.img_to_array(img)
        img = np.expand_dims(img, axis=0)
        img = preprocess_input(img)
        feat = model.predict(img)
        norm_feat = feat[0] / LA.norm(feat[0])
        return norm_feat

    image1 = extract_feat(image1)
    image2 = extract_feat(image2)
    return np.dot(image1, image2.T)

class roibatchLoader(data.Dataset):
    def __getitem__(self, index):
        if self.training:
            c, qh, qw = query.shape
            gtb = gt_boxes_padding[:num_boxes]
            target_list = []
            for i in range(num_boxes):
                target = gtb[i]
                flag = target[-1]
                if flag == 1:
                    target_list.append(target)
            if len(target_list) > 0:
                idx = np.random.choice(len(target_list))
                target = target_list[idx]
                x1 = target[0].int().item()
                y1 = target[1].int().item()
                x2 = target[2].int().item()
                y2 = target[3].int().item()
                if((x2 - x1) > 10 and (y2 - y1) > 10):
                    probability = vgg_match(padding_data , query)
                    if probability < 0.5:
                        crop_area = padding_data[:,y1:y2,x1:x2]
                        query_replace = F.interpolate(query.unsqueeze(0),size=[y2 - y1, x2 - x1]).squeeze(0)
                        crop_area = F.interpolate(crop_area.unsqueeze(0),size=[qh,qw]).squeeze(0)
                        padding_data[:,y1:y2,x1:x2] = query_replace
                        query = crop_area
```



### Barlow Twins

|                       | Epoch 10 | Max   |
| --------------------- | -------- | ----- |
| 原代码使用margin loss | 0.232    | 0.238 |
| 原代码使用cross       | 0.242    | 0.245 |
|                       |          |       |
|                       |          |       |
|                       |          |       |
|                       |          |       |
|                       |          |       |



```python
from model.faster_rcnn.faster_rcnn_bt import _fasterRCNN # /lib/model/faster_rcnn/resnet_bt.py

# /lib/model/faster_rcnn/faster_rcnn_bt.py
def off_diagonal(x):
    # return a flattened view of the off-diagonal elements of a square matrix
    n, m = x.shape
    assert n == m
    return x.flatten()[:-1].view(n - 1, n + 1)[:, 1:].flatten()
class _fasterRCNN(nn.Module):
    def __init__(self, classes, class_agnostic):
        projector = '8192-8192-8192'
        sizes = [2048] + list(map(int, projector.split('-')))
        self.bn = nn.BatchNorm1d(sizes[-1], affine=False)
        self.lambd = 0.0051
    def forward(self, im_data, query, im_info, gt_boxes, num_boxes):
        cat_feat = torch.cat((pooled_feat,query_feat), dim=2).view(-1, 4096)
        score = self.RCNN_cls_score(cat_feat)
        if self.training:
            # empirical cross-correlation matrix
            c = self.bn(pooled_feat).T @ self.bn(query_feat)
            # sum the cross-correlation matrix between all gpus
            c.div_(self.args.batch_size)
            torch.distributed.all_reduce(c)
            on_diag = torch.diagonal(c).add_(-1).pow_(2).sum()
            off_diag = off_diagonal(c).pow_(2).sum()
            margin_loss = on_diag + self.lambd * off_diag
   
```

margin_loss = on_diag + self.lambd * off_diag

margin_loss = margin_loss * 0.000001

margin_loss = torch.sigmoid(margin_loss)

|      |       |           |       |       |       |       |       |       |       |       |       |       |
| ---- | ----- | --------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1  | 0.100 | 0.201     | 0.090 | 0.054 | 0.116 | 0.163 | 0.109 | 0.251 | 0.278 | 0.165 | 0.302 | 0.427 |
| 1_2  | 0.103 | 0.201     | 0.099 | 0.066 | 0.109 | 0.178 | 0.123 | 0.256 | 0.299 | 0.197 | 0.336 | 0.449 |
| 1_3  | 0.111 | 0.211     | 0.106 | 0.070 | 0.123 | 0.169 | 0.126 | 0.274 | 0.307 | 0.197 | 0.348 | 0.467 |
| 1_4  | 0.110 | 0.217     | 0.100 | 0.060 | 0.120 | 0.170 | 0.126 | 0.270 | 0.308 | 0.209 | 0.338 | 0.462 |
| 1_5  | 0.131 | 0.240     | 0.131 | 0.088 | 0.144 | 0.214 | 0.144 | 0.299 | 0.338 | 0.204 | 0.380 | 0.504 |
| 1_6  | 0.126 | 0.232     | 0.123 | 0.072 | 0.141 | 0.211 | 0.138 | 0.289 | 0.329 | 0.202 | 0.364 | 0.496 |
| 1_7  | 0.138 | 0.244     | 0.138 | 0.070 | 0.149 | 0.220 | 0.145 | 0.297 | 0.339 | 0.210 | 0.374 | 0.515 |
| 1_8  | 0.126 | 0.231     | 0.124 | 0.057 | 0.141 | 0.194 | 0.139 | 0.292 | 0.334 | 0.199 | 0.376 | 0.500 |
| 1_9  | 0.129 | 0.236     | 0.130 | 0.058 | 0.144 | 0.204 | 0.141 | 0.290 | 0.333 | 0.211 | 0.378 | 0.493 |
| 1_10 | 0.136 | **0.242** | 0.135 | 0.059 | 0.147 | 0.221 | 0.145 | 0.295 | 0.337 | 0.197 | 0.372 | 0.500 |
| 1_11 | 0.134 | 0.242     | 0.131 | 0.066 | 0.146 | 0.214 | 0.142 | 0.293 | 0.333 | 0.199 | 0.373 | 0.495 |
| 1_12 | 0.134 | 0.242     | 0.130 | 0.067 | 0.143 | 0.223 | 0.145 | 0.295 | 0.336 | 0.208 | 0.375 | 0.498 |
| 1_13 | 0.130 | 0.235     | 0.128 | 0.065 | 0.137 | 0.213 | 0.144 | 0.296 | 0.337 | 0.209 | 0.368 | 0.503 |
| 1_14 | 0.132 | 0.241     | 0.129 | 0.064 | 0.143 | 0.217 | 0.141 | 0.289 | 0.329 | 0.209 | 0.365 | 0.486 |
| 1_15 | 0.132 | 0.241     | 0.130 | 0.066 | 0.141 | 0.217 | 0.140 | 0.291 | 0.332 | 0.200 | 0.365 | 0.499 |
| 1_16 | 0.134 | **0.245** | 0.132 | 0.069 | 0.143 | 0.219 | 0.141 | 0.296 | 0.334 | 0.202 | 0.368 | 0.502 |





### 添加simCLR的projector 0.248-0.252

| projector          | epoch10   | best（epoch）          |
| ------------------ | --------- | ---------------------- |
| 原论文代码         | 0.232     | 238(11)                |
| 目标互换代码       | 0.241     | 0.246(8)               |
| 64在目标互换基础上 | 0.245     | 0.245（9、10、11、15） |
| 128                | 0.247     | **0.252**(13、16)      |
| 256                | 0.237     | 0.241(11)              |
| 512                | **0.248** | 0.248(10)              |
| 2048               | 0.241     | 0.243(6)               |

/media/sdb1/Data/dyy/One-Shot-Object-Detection 在目标互换的基础上 128 2048 64

/media/sdb1/Data/dyy/One-Shot-Object-Detection-switch 在目标互换的基础上  256 512

```python
# 修改的东西有
One-Shot-Object-Detection/trainval_no_switch.py
修改line34:from model.faster_rcnn.resnet_p import resnet

新建One-Shot-Object-Detection/lib/model/faster_rcnn/faster_rcnn_p.py
添加line239-240：
pooled_feat = self.projector(pooled_feat)
query_feat = self.projector(query_feat)
修改line241：
pooled_feat = torch.cat((pooled_feat,query_feat), dim=2).view(-1, 256)
添加line151-155:
self.projector = nn.Sequential(
            nn.Linear(2048, 2048, bias=False),
            nn.ReLU(),
            nn.Linear(2048, 128, bias=False),
        )

新建One-Shot-Object-Detection/lib/model/faster_rcnn/resnet_p.py
修改line6:from model.faster_rcnn.faster_rcnn_p import _fasterRCNN
修改line259-263:
self.RCNN_cls_score = nn.Sequential(
    nn.Linear(128*2, 8),
    nn.Linear(8, 2)
)

测试时修改One-Shot-Object-Detection/test_net.py
line29:from model.faster_rcnn.resnet_p import resnet
```

| AP(64)               | 1_4   | 1_5   | 1_6   | 1_7   | 1_8   | 1_9       | 1_10      | 1_11      | 1_12  | 1_13  | 1_14  | 1_15      |
| -------------------- | ----- | ----- | ----- | ----- | ----- | --------- | --------- | --------- | ----- | ----- | ----- | --------- |
| 0.50:0.95-all-100    | 0.097 | 0.125 | 0.125 | 0.131 | 0.129 | 0.134     | 0.136     | 0.136     | 0.136 | 0.134 | 0.134 | 0.135     |
| 0.50-all-100         | 0.197 | 0.235 | 0.238 | 0.236 | 0.239 | **0.245** | **0.245** | **0.245** | 0.244 | 0.239 | 0.242 | **0.245** |
| 0.75-all-100         | 0.088 | 0.120 | 0.117 | 0.127 | 0.130 | 0.138     | 0.134     | 0.134     | 0.131 | 0.133 | 0.130 | 0.133     |
| 0.50:0.95-small-100  | 0.039 | 0.056 | 0.068 | 0.081 | 0.089 | 0.072     | 0.071     | 0.093     | 0.075 | 0.079 | 0.072 | 0.075     |
| 0.50:0.95-medium-100 | 0.111 | 0.142 | 0.144 | 0.141 | 0.143 | 0.142     | 0.148     | 0.150     | 0.148 | 0.148 | 0.150 | 0.149     |
| 0.50:0.95-large-100  | 0.147 | 0.200 | 0.206 | 0.217 | 0.207 | 0.214     | 0.221     | 0.225     | 0.225 | 0.222 | 0.220 | 0.224     |
| **AR**               |       |       |       |       |       |           |           |           |       |       |       |           |
| 0.50:0.95-all-1      | 0.116 | 0.134 | 0.136 | 0.139 | 0.136 | 0.140     | 0.140     | 0.142     | 0.143 | 0.141 | 0.139 | 0.140     |
| 0.50:0.95-all-10     | 0.253 | 0.283 | 0.280 | 0.283 | 0.283 | 0.291     | 0.288     | 0.292     | 0.293 | 0.290 | 0.291 | 0.292     |
| 0.50:0.95-all-100    | 0.292 | 0.322 | 0.324 | 0.326 | 0.327 | 0.328     | 0.332     | 0.332     | 0.332 | 0.330 | 0.330 | 0.332     |
| 0.50:0.95-small-100  | 0.165 | 0.190 | 0.209 | 0.203 | 0.205 | 0.203     | 0.208     | 0.203     | 0.203 | 0.208 | 0.211 | 0.211     |
| 0.50:0.95-medium-100 | 0.328 | 0.358 | 0.360 | 0.366 | 0.368 | 0.364     | 0.370     | 0.373     | 0.366 | 0.372 | 0.365 | 0.372     |
| 0.50:0.95-large-100  | 0.445 | 0.490 | 0.485 | 0.493 | 0.492 | 0.492     | 0.491     | 0.492     | 0.498 | 0.493 | 0.492 | 0.495     |



| AP(512)              | 1_1   | 1_2   | 1_3   | 1_4   | 1_5   | 1_6   | 1_7   | 1_8   | 1_9   | 1_10      | 1_11  | 1_12  | 1_13  | 1_14  | 1_15  |
| -------------------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | --------- | ----- | ----- | ----- | ----- | ----- |
| 0.50:0.95-all-100    | 0.087 | 0.084 | 0.109 | 0.100 | 0.125 | 0.128 | 0.126 | 0.129 | 0.123 | 0.134     | 0.131 | 0.133 | 0.132 | 0.131 | 0.133 |
| 0.50-all-100         | 0.188 | 0.182 | 0.218 | 0.203 | 0.228 | 0.241 | 0.230 | 0.238 | 0.224 | **0.248** | 0.244 | 0.240 | 0.240 | 0.239 | 0.243 |
| 0.75-all-100         | 0.079 | 0.072 | 0.099 | 0.097 | 0.120 | 0.121 | 0.121 | 0.127 | 0.126 | 0.131     | 0.127 | 0.134 | 0.131 | 0.127 | 0.130 |
| 0.50:0.95-small-100  | 0.063 | 0.049 | 0.056 | 0.045 | 0.065 | 0.063 | 0.060 | 0.093 | 0.062 | 0.067     | 0.065 | 0.063 | 0.064 | 0.061 | 0.062 |
| 0.50:0.95-medium-100 | 0.105 | 0.095 | 0.126 | 0.105 | 0.142 | 0.153 | 0.146 | 0.137 | 0.134 | 0.154     | 0.150 | 0.152 | 0.151 | 0.143 | 0.150 |
| 0.50:0.95-large-100  | 0.135 | 0.120 | 0.174 | 0.164 | 0.196 | 0.203 | 0.202 | 0.214 | 0.202 | 0.211     | 0.208 | 0.211 | 0.208 | 0.211 | 0.216 |
| **AR**               |       |       |       |       |       |       |       |       |       |           |       |       |       |       |       |
| 0.50:0.95-all-1      | 0.104 | 0.101 | 0.119 | 0.112 | 0.138 | 0.140 | 0.139 | 0.140 | 0.137 | 0.141     | 0.138 | 0.140 | 0.140 | 0.143 | 0.142 |
| 0.50:0.95-all-10     | 0.232 | 0.227 | 0.269 | 0.258 | 0.282 | 0.287 | 0.283 | 0.287 | 0.278 | 0.287     | 0.283 | 0.290 | 0.286 | 0.287 | 0.288 |
| 0.50:0.95-all-100    | 0.265 | 0.275 | 0.308 | 0.297 | 0.319 | 0.329 | 0.323 | 0.332 | 0.323 | 0.328     | 0.324 | 0.330 | 0.327 | 0.328 | 0.327 |
| 0.50:0.95-small-100  | 0.163 | 0.160 | 0.198 | 0.183 | 0.204 | 0.193 | 0.206 | 0.205 | 0.200 | 0.210     | 0.203 | 0.202 | 0.205 | 0.217 | 0.204 |
| 0.50:0.95-medium-100 | 0.306 | 0.312 | 0.343 | 0.331 | 0.362 | 0.381 | 0.366 | 0.367 | 0.360 | 0.368     | 0.363 | 0.368 | 0.364 | 0.361 | 0.357 |
| 0.50:0.95-large-100  | 0.399 | 0.398 | 0.455 | 0.440 | 0.469 | 0.479 | 0.473 | 0.489 | 0.486 | 0.480     | 0.477 | 0.491 | 0.476 | 0.489 | 0.492 |

| 1024 |       |       |       |       |       |       |       |       |       |       |       |       |
| ---- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1_1  | 0.089 | 0.191 | 0.076 | 0.044 | 0.110 | 0.150 | 0.098 | 0.225 | 0.259 | 0.113 | 0.294 | 0.408 |
| 1_2  | 0.091 | 0.196 | 0.078 | 0.047 | 0.105 | 0.138 | 0.113 | 0.246 | 0.278 | 0.168 | 0.300 | 0.420 |
| 1_3  | 0.104 | 0.208 | 0.097 | 0.054 | 0.137 | 0.163 | 0.114 | 0.255 | 0.297 | 0.188 | 0.339 | 0.443 |
| 1_4  | 0.108 | 0.216 | 0.099 | 0.056 | 0.125 | 0.174 | 0.122 | 0.264 | 0.307 | 0.172 | 0.352 | 0.447 |
| 1_5  | 0.126 | 0.236 | 0.122 | 0.065 | 0.149 | 0.195 | 0.138 | 0.286 | 0.327 | 0.210 | 0.368 | 0.474 |
| 1_6  | 0.131 | 0.240 | 0.129 | 0.065 | 0.151 | 0.200 | 0.142 | 0.287 | 0.328 | 0.208 | 0.361 | 0.486 |
| 1_7  | 0.134 | 0.243 | 0.135 | 0.056 | 0.148 | 0.204 | 0.138 | 0.288 | 0.327 | 0.187 | 0.363 | 0.479 |
| 1_8  | 0.128 | 0.239 | 0.121 | 0.063 | 0.145 | 0.193 | 0.138 | 0.282 | 0.322 | 0.196 | 0.365 | 0.462 |
| 1_9  | 0.128 | 0.236 | 0.124 | 0.073 | 0.134 | 0.204 | 0.141 | 0.283 | 0.323 | 0.207 | 0.350 | 0.469 |
| 1_10 | 0.132 | 0.240 | 0.136 | 0.062 | 0.141 | 0.207 | 0.142 | 0.292 | 0.333 | 0.202 | 0.365 | 0.495 |

| AP(2048)             | 1_1   | 1_2   | 1_3   | 1_4   | 1_5   | 1_6       | 1_7   | 1_8   | 1_9   | 1_10  |
| -------------------- | ----- | ----- | ----- | ----- | ----- | --------- | ----- | ----- | ----- | ----- |
| 0.50:0.95-all-100    | 0.092 | 0.101 | 0.090 | 0.105 | 0.127 | 0.131     | 0.129 | 0.127 | 0.129 | 0.135 |
| 0.50-all-100         | 0.192 | 0.199 | 0.184 | 0.211 | 0.232 | **0.243** | 0.236 | 0.233 | 0.238 | 0.241 |
| 0.75-all-100         | 0.085 | 0.092 | 0.081 | 0.098 | 0.126 | 0.125     | 0.132 | 0.122 | 0.124 | 0.132 |
| 0.50:0.95-small-100  | 0.078 | 0.051 | 0.050 | 0.058 | 0.066 | 0.061     | 0.066 | 0.064 | 0.063 | 0.065 |
| 0.50:0.95-medium-100 | 0.117 | 0.115 | 0.097 | 0.126 | 0.140 | 0.141     | 0.143 | 0.144 | 0.146 | 0.144 |
| 0.50:0.95-large-100  | 0.144 | 0.170 | 0.150 | 0.160 | 0.209 | 0.214     | 0.207 | 0.207 | 0.211 | 0.224 |
| **AR**               |       |       |       |       |       |           |       |       |       |       |
| 0.50:0.95-all-1      | 0.108 | 0.116 | 0.108 | 0.117 | 0.137 | 0.139     | 0.136 | 0.136 | 0.138 | 0.143 |
| 0.50:0.95-all-10     | 0.244 | 0.250 | 0.240 | 0.259 | 0.282 | 0.284     | 0.281 | 0.282 | 0.284 | 0.293 |
| 0.50:0.95-all-100    | 0.275 | 0.282 | 0.283 | 0.296 | 0.321 | 0.324     | 0.322 | 0.321 | 0.327 | 0.335 |
| 0.50:0.95-small-100  | 0.153 | 0.165 | 0.153 | 0.174 | 0.188 | 0.186     | 0.190 | 0.209 | 0.202 | 0.203 |
| 0.50:0.95-medium-100 | 0.313 | 0.321 | 0.326 | 0.336 | 0.348 | 0.354     | 0.358 | 0.360 | 0.372 | 0.371 |
| 0.50:0.95-large-100  | 0.405 | 0.423 | 0.415 | 0.449 | 0.496 | 0.493     | 0.484 | 0.481 | 0.477 | 0.500 |



| AP(256)              | 1_1   | 1_2   | 1_3   | 1_4   | 1_5   | 1_6   | 1_7   | 1_8   | 1_9   | 1_10  | 1_11      | 1_12  |
| -------------------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | --------- | ----- |
| 0.50:0.95-all-100    | 0.081 | 0.104 | 0.102 | 0.103 | 0.122 | 0.124 | 0.127 | 0.120 | 0.126 | 0.130 | 0.130     | 0.128 |
| 0.50-all-100         | 0.183 | 0.210 | 0.201 | 0.203 | 0.229 | 0.232 | 0.237 | 0.228 | 0.233 | 0.237 | **0.241** | 0.235 |
| 0.75-all-100         | 0.061 | 0.095 | 0.096 | 0.095 | 0.113 | 0.116 | 0.123 | 0.116 | 0.122 | 0.126 | 0.123     | 0.125 |
| 0.50:0.95-small-100  | 0.060 | 0.061 | 0.060 | 0.055 | 0.062 | 0.063 | 0.054 | 0.057 | 0.060 | 0.060 | 0.058     | 0.059 |
| 0.50:0.95-medium-100 | 0.093 | 0.127 | 0.130 | 0.116 | 0.139 | 0.140 | 0.147 | 0.134 | 0.135 | 0.142 | 0.143     | 0.142 |
| 0.50:0.95-large-100  | 0.120 | 0.164 | 0.165 | 0.153 | 0.199 | 0.203 | 0.211 | 0.202 | 0.214 | 0.219 | 0.216     | 0.210 |
| **AR**               |       |       |       |       |       |       |       |       |       |       |           |       |
| 0.50:0.95-all-1      | 0.098 | 0.119 | 0.116 | 0.117 | 0.133 | 0.139 | 0.138 | 0.132 | 0.135 | 0.137 | 0.138     | 0.136 |
| 0.50:0.95-all-10     | 0.218 | 0.256 | 0.250 | 0.264 | 0.273 | 0.281 | 0.280 | 0.281 | 0.290 | 0.288 | 0.289     | 0.286 |
| 0.50:0.95-all-100    | 0.251 | 0.289 | 0.283 | 0.309 | 0.312 | 0.320 | 0.324 | 0.322 | 0.332 | 0.332 | 0.330     | 0.328 |
| 0.50:0.95-small-100  | 0.139 | 0.164 | 0.173 | 0.182 | 0.202 | 0.195 | 0.205 | 0.199 | 0.206 | 0.210 | 0.200     | 0.213 |
| 0.50:0.95-medium-100 | 0.283 | 0.331 | 0.315 | 0.346 | 0.351 | 0.353 | 0.359 | 0.351 | 0.367 | 0.366 | 0.365     | 0.362 |
| 0.50:0.95-large-100  | 0.382 | 0.434 | 0.438 | 0.474 | 0.466 | 0.480 | 0.481 | 0.483 | 0.493 | 0.495 | 0.490     | 0.489 |




| AP(128)              | 1_1   | 1_2   | 1_3   | 1_4   | 1_5   | 1_6   | 1_7   | 1_8   | 1_9   | 1_10  | 1_11  | 1_12  | 1_13      | 1_14  | 1_15  | 1_16      | 1_17  | 1_18  | 1_19  | 1_20  |
| -------------------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | --------- | ----- | ----- | --------- | ----- | ----- | ----- | ----- |
| 0.50:0.95-all-100    | 0.089 | 0.097 | 0.103 | 0.101 | 0.129 | 0.127 | 0.130 | 0.131 | 0.128 | 0.133 | 0.135 | 0.134 | 0.137     | 0.135 | 0.136 | 0.137     | 0.134 | 0.134 | 0.135 | 0.135 |
| 0.50-all-100         | 0.191 | 0.205 | 0.207 | 0.197 | 0.235 | 0.236 | 0.240 | 0.241 | 0.236 | 0.247 | 0.250 | 0.247 | **0.252** | 0.249 | 0.249 | **0.252** | 0.248 | 0.246 | 0.249 | 0.247 |
| 0.75-all-100         | 0.075 | 0.085 | 0.092 | 0.095 | 0.126 | 0.125 | 0.129 | 0.131 | 0.124 | 0.132 | 0.133 | 0.135 | 0.137     | 0.132 | 0.136 | 0.136     | 0.132 | 0.133 | 0.134 | 0.135 |
| 0.50:0.95-small-100  | 0.050 | 0.060 | 0.049 | 0.054 | 0.063 | 0.057 | 0.086 | 0.065 | 0.053 | 0.061 | 0.062 | 0.061 | 0.061     | 0.060 | 0.059 | 0.059     | 0.057 | 0.057 | 0.057 | 0.059 |
| 0.50:0.95-medium-100 | 0.113 | 0.120 | 0.125 | 0.111 | 0.134 | 0.138 | 0.142 | 0.146 | 0.140 | 0.150 | 0.151 | 0.150 | 0.151     | 0.152 | 0.149 | 0.151     | 0.151 | 0.150 | 0.152 | 0.150 |
| 0.50:0.95-large-100  | 0.154 | 0.161 | 0.169 | 0.161 | 0.216 | 0.206 | 0.212 | 0.198 | 0.201 | 0.205 | 0.209 | 0.211 | 0.223     | 0.214 | 0.219 | 0.220     | 0.210 | 0.211 | 0.216 | 0.216 |
| **AR**               |       |       |       |       |       |       |       |       |       |       |       |       |           |       |       |           |       |       |       |       |
| 0.50:0.95-all-1      | 0.108 | 0.120 | 0.116 | 0.115 | 0.137 | 0.137 | 0.137 | 0.139 | 0.139 | 0.141 | 0.144 | 0.142 | 0.145     | 0.143 | 0.145 | 0.145     | 0.143 | 0.141 | 0.144 | 0.143 |
| 0.50:0.95-all-10     | 0.235 | 0.247 | 0.257 | 0.253 | 0.284 | 0.275 | 0.288 | 0.281 | 0.285 | 0.286 | 0.288 | 0.286 | 0.294     | 0.290 | 0.292 | 0.292     | 0.289 | 0.289 | 0.289 | 0.291 |
| 0.50:0.95-all-100    | 0.267 | 0.283 | 0.296 | 0.294 | 0.325 | 0.320 | 0.328 | 0.323 | 0.324 | 0.326 | 0.328 | 0.327 | 0.333     | 0.329 | 0.332 | 0.333     | 0.329 | 0.328 | 0.329 | 0.331 |
| 0.50:0.95-small-100  | 0.161 | 0.153 | 0.177 | 0.191 | 0.198 | 0.194 | 0.196 | 0.189 | 0.162 | 0.200 | 0.198 | 0.196 | 0.199     | 0.194 | 0.194 | 0.196     | 0.195 | 0.193 | 0.193 | 0.195 |
| 0.50:0.95-medium-100 | 0.308 | 0.317 | 0.340 | 0.327 | 0.356 | 0.352 | 0.358 | 0.358 | 0.359 | 0.362 | 0.361 | 0.362 | 0.362     | 0.362 | 0.362 | 0.366     | 0.363 | 0.365 | 0.363 | 0.365 |
| 0.50:0.95-large-100  | 0.399 | 0.434 | 0.444 | 0.443 | 0.477 | 0.481 | 0.495 | 0.487 | 0.479 | 0.482 | 0.483 | 0.490 | 0.502     | 0.494 | 0.504 | 0.498     | 0.495 | 0.488 | 0.498 | 0.503 |




### 目标互换自己训练 0.241-0.246


**刘静师姐代码，自己训练（目标互换）：coco_switch_LJcode**

/media/sdb1/Data/dyy/One-Shot-Object-Detection-switch/trainval_switch.py

| AP                   | 1_3   | 1_4   | 1_5   | 1_6   | 1_7   | 1_8       | 1_9   | 1_10  | 1_11  | 1_12  | 1_13  | 1_14  | 1_15  | 1_16  | 1_17  | 1_18  | 1_19  | 1_20  |
| -------------------- | ----- | ----- | ----- | ----- | ----- | --------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 0.50:0.95-all-100    | 0.100 | 0.114 | 0.127 | 0.125 | 0.132 | 0.135     | 0.125 | 0.133 | 0.132 | 0.131 | 0.133 | 0.134 | 0.133 | 0.133 | 0.133 | 0.131 | 0.132 | 0.132 |
| 0.50-all-100         | 0.203 | 0.221 | 0.238 | 0.233 | 0.244 | **0.246** | 0.231 | 0.241 | 0.237 | 0.239 | 0.241 | 0.245 | 0.241 | 0.241 | 0.244 | 0.241 | 0.241 | 0.242 |
| 0.75-all-100         | 0.088 | 0.111 | 0.127 | 0.120 | 0.129 | 0.130     | 0.123 | 0.129 | 0.126 | 0.128 | 0.132 | 0.131 | 0.129 | 0.129 | 0.129 | 0.126 | 0.129 | 0.129 |
| 0.50:0.95-small-100  | 0.052 | 0.056 | 0.082 | 0.069 | 0.062 | 0.063     | 0.094 | 0.061 | 0.058 | 0.095 | 0.062 | 0.064 | 0.066 | 0.065 | 0.065 | 0.066 | 0.067 | 0.066 |
| 0.50:0.95-medium-100 | 0.122 | 0.125 | 0.134 | 0.126 | 0.147 | 0.151     | 0.137 | 0.142 | 0.145 | 0.143 | 0.146 | 0.148 | 0.144 | 0.143 | 0.145 | 0.142 | 0.144 | 0.144 |
| 0.50:0.95-large-100  | 0.163 | 0.177 | 0.214 | 0.215 | 0.215 | 0.233     | 0.218 | 0.232 | 0.225 | 0.219 | 0.225 | 0.226 | 0.227 | 0.227 | 0.228 | 0.226 | 0.230 | 0.227 |
| **AR**               |       |       |       |       |       |           |       |       |       |       |       |       |       |       |       |       |       |       |
| 0.50:0.95-all-1      | 0.117 | 0.126 | 0.134 | 0.135 | 0.143 | 0.141     | 0.136 | 0.142 | 0.141 | 0.141 | 0.143 | 0.139 | 0.141 | 0.144 | 0.142 | 0.142 | 0.143 | 0.141 |
| 0.50:0.95-all-10     | 0.254 | 0.267 | 0.284 | 0.288 | 0.293 | 0.298     | 0.285 | 0.298 | 0.291 | 0.297 | 0.295 | 0.296 | 0.296 | 0.298 | 0.294 | 0.296 | 0.297 | 0.296 |
| 0.50:0.95-all-100    | 0.291 | 0.305 | 0.322 | 0.326 | 0.328 | 0.335     | 0.327 | 0.339 | 0.333 | 0.337 | 0.336 | 0.336 | 0.336 | 0.339 | 0.337 | 0.338 | 0.338 | 0.337 |
| 0.50:0.95-small-100  | 0.160 | 0.187 | 0.186 | 0.199 | 0.211 | 0.216     | 0.210 | 0.214 | 0.207 | 0.211 | 0.212 | 0.206 | 0.206 | 0.210 | 0.207 | 0.207 | 0.207 | 0.205 |
| 0.50:0.95-medium-100 | 0.333 | 0.337 | 0.352 | 0.352 | 0.366 | 0.373     | 0.368 | 0.374 | 0.371 | 0.375 | 0.378 | 0.370 | 0.374 | 0.374 | 0.373 | 0.375 | 0.374 | 0.372 |
| 0.50:0.95-large-100  | 0.433 | 0.466 | 0.492 | 0.492 | 0.487 | 0.492     | 0.485 | 0.504 | 0.496 | 0.495 | 0.491 | 0.490 | 0.496 | 0.498 | 0.494 | 0.498 | 0.498 | 0.495 |



### 原代码（目标不互换）：coco 0.232-0.238

/media/sdb1/Data/dyy/One-Shot-Object-Detection/trainval_no_switch.py

| AP                   | 1_5   | 1_6   | 1_7   | 1_8   | 1_9   | 1_10  | 1_11      | 1_12  | 1_13  | 1_14  | 1_15  | 1_16  | 1_17  | 1_18  | 1_19  | 1_20  |
| -------------------- | ----- | ----- | ----- | ----- | ----- | ----- | --------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 0.50:0.95-all-100    | 0.127 | 0.129 | 0.130 | 0.136 | 0.129 | 0.131 | 0.134     | 0.132 | 0.131 | 0.134 | 0.130 | 0.132 | 0.132 | 0.131 | 0.132 | 0.132 |
| 0.50-all-100         | 0.233 | 0.234 | 0.237 | 0.243 | 0.233 | 0.232 | **0.238** | 0.235 | 0.232 | 0.235 | 0.232 | 0.234 | 0.231 | 0.232 | 0.232 | 0.232 |
| 0.75-all-100         | 0.127 | 0.127 | 0.123 | 0.134 | 0.127 | 0.132 | 0.135     | 0.134 | 0.133 | 0.136 | 0.130 | 0.132 | 0.132 | 0.131 | 0.133 | 0.134 |
| 0.50:0.95-small-100  | 0.062 | 0.063 | 0.060 | 0.067 | 0.063 | 0.060 | 0.063     | 0.064 | 0.063 | 0.061 | 0.063 | 0.063 | 0.063 | 0.064 | 0.062 | 0.062 |
| 0.50:0.95-medium-100 | 0.134 | 0.133 | 0.134 | 0.137 | 0.132 | 0.134 | 0.137     | 0.136 | 0.133 | 0.134 | 0.133 | 0.134 | 0.135 | 0.134 | 0.135 | 0.134 |
| 0.50:0.95-large-100  | 0.207 | 0.209 | 0.211 | 0.223 | 0.216 | 0.221 | 0.225     | 0.220 | 0.218 | 0.221 | 0.218 | 0.215 | 0.214 | 0.215 | 0.216 | 0.220 |
| **AR**               |       |       |       |       |       |       |           |       |       |       |       |       |       |       |       |       |
| 0.50:0.95-all-1      | 0.137 | 0.137 | 0.140 | 0.140 | 0.137 | 0.140 | 0.138     | 0.139 | 0.139 | 0.142 | 0.141 | 0.142 | 0.142 | 0.140 | 0.142 | 0.140 |
| 0.50:0.95-all-10     | 0.288 | 0.291 | 0.290 | 0.296 | 0.292 | 0.291 | 0.296     | 0.292 | 0.287 | 0.293 | 0.290 | 0.292 | 0.291 | 0.292 | 0.290 | 0.288 |
| 0.50:0.95-all-100    | 0.330 | 0.330 | 0.329 | 0.339 | 0.334 | 0.335 | 0.336     | 0.335 | 0.329 | 0.335 | 0.332 | 0.334 | 0.333 | 0.333 | 0.332 | 0.332 |
| 0.50:0.95-small-100  | 0.176 | 0.192 | 0.202 | 0.181 | 0.172 | 0.185 | 0.185     | 0.186 | 0.194 | 0.195 | 0.192 | 0.193 | 0.189 | 0.189 | 0.187 | 0.187 |
| 0.50:0.95-medium-100 | 0.359 | 0.363 | 0.365 | 0.380 | 0.373 | 0.376 | 0.372     | 0.371 | 0.368 | 0.365 | 0.363 | 0.367 | 0.368 | 0.368 | 0.368 | 0.368 |
| 0.50:0.95-large-100  | 0.499 | 0.496 | 0.494 | 0.494 | 0.493 | 0.500 | 0.504     | 0.496 | 0.479 | 0.501 | 0.492 | 0.495 | 0.492 | 0.491 | 0.491 | 0.490 |



**刘静师姐权重（目标互换）：coco_LJ**

| AP                   | 1_1_354981 | 1_10_1663 | 1_10_354981 | 2_10_1663 | 3_10_1663 | 4_10_1663 |
| -------------------- | ---------- | --------- | ----------- | --------- | --------- | --------- |
| 0.50:0.95-all-100    | 0.099      | 0.118     | 0.132       | 0.218     | 0.223     | 0.215     |
| 0.50-all-100         | 0.207      | 0.233     | 0.241       | 0.409     | 0.407     | 0.398     |
| 0.75-all-100         | 0.086      | 0.110     | 0.128       | 0.215     | 0.222     | 0.208     |
| 0.50:0.95-small-100  | 0.048      | 0.055     | 0.094       | 0.090     | 0.086     | 0.088     |
| 0.50:0.95-medium-100 | 0.119      | 0.140     | 0.144       | 0.245     | 0.242     | 0.237     |
| 0.50:0.95-large-100  | 0.166      | 0.186     | 0.218       | 0.336     | 0.344     | 0.326     |
| **AR**               |            |           |             |           |           |           |
| 0.50:0.95-all-1      | 0.105      | 0.130     | 0.138       | 0.207     | 0.213     | 0.206     |
| 0.50:0.95-all-10     | 0.242      | 0.261     | 0.287       | 0.331     | 0.338     | 0.329     |
| 0.50:0.95-all-100    | 0.273      | 0.290     | 0.329       | 0.348     | 0.354     | 0.348     |
| 0.50:0.95-small-100  | 0.152      | 0.154     | 0.210       | 0.152     | 0.147     | 0.151     |
| 0.50:0.95-medium-100 | 0.307      | 0.325     | 0.363       | 0.393     | 0.389     | 0.381     |
| 0.50:0.95-large-100  | 0.415      | 0.448     | 0.482       | 0.521     | 0.547     | 0.525     |



### 添加sac没有改成

```python
# 修改的东西有
One-Shot-Object-Detection-switch/trainval_switch.py
line34:from model.faster_rcnn.resnet_sac import resnet

```

/home/ubuntu/miniconda3/envs/OSOD2/lib/python3.6

g++ -fPIC -shared deform_conv_cuda.cpp -I /home/ubuntu/miniconda3/envs/OSOD2/lib/python3.6 -o deform_conv_cuda.so







```python
CUDA_VISIBLE_DEVICES=$GPU_ID python trainval_net.py \
                   --dataset coco --net res50 \
                   --bs $BATCH_SIZE --nw $WORKER_NUMBER \
                   --lr $LEARNING_RATE --lr_decay_step $DECAY_STEP \
                   --cuda --g $SPLIT --seen $SEEN
python test_net.py --dataset coco --net res50 \
                   --s $SESSION --checkepoch $EPOCH --p $CHECKPOINT \
                   --cuda --g $SPLIT
```

Specify the model session, checkepoch and checkpoint, e.g., SESSION=1, EPOCH=10, CHECKPOINT=1663.

If you want to test our model checkpoint, simple run

For coco first group:

```
python test_net.py --s 1  --g 1 --a 4 --cuda
```

For coco second group:

```
python test_net.py --s 2  --g 2 --a 4 --cuda
```

python test_net.py --dataset coco --net res50 \
                   --s $SESSION --checkepoch $EPOCH --p $CHECKPOINT \
                   --cuda --g $SPLIT
例如：
SESSION=1, EPOCH=10, CHECKPOINT=1663

```shell
python trainval_net.py --dataset coco --net res50 --bs 6 --nw 2 --cuda --g 1 --seen 1
CUDA_VISIBLE_DEVICES=3 python trainval_net.py --dataset coco --net res50 --bs 8 --nw 2 --cuda --g 1 --seen 1
/mnt/4T/DYY/One-Shot-Object-Detection/data/coco_reference_image/coco_train2017_e2e_mask_rcnn_R_101_FPN_1x_caffe2.pkl
```



